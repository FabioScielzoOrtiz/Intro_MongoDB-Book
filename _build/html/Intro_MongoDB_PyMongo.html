
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Intro to MongDB (NoSQL) &#8212; Introduction to MongoDB through PyMongo</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Intro_MongoDB_PyMongo';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Introduction to MongoDB through PyMongo" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo1.png" class="logo__image only-light" alt="Introduction to MongoDB through PyMongo - Home"/>
    <script>document.write(`<img src="_static/logo1.png" class="logo__image only-dark" alt="Introduction to MongoDB through PyMongo - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introduction to MongoDB through PyMongo
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Intro to MongDB (NoSQL)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/FabioScielzoOrtiz/MongoDB" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/FabioScielzoOrtiz/MongoDB/issues/new?title=Issue%20on%20page%20%2FIntro_MongoDB_PyMongo.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Intro_MongoDB_PyMongo.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Intro to MongDB (NoSQL)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#requirements">Requirements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#see-your-data-bases">See your data bases</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#remove-a-data-base">Remove a data base</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-new-data-base">Create a new data base</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-new-collection-in-the-data-base">Create a new collection in the data base</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregate-a-new-document-into-a-collection-from-a-data-base">Aggregate a new document into a collection from a data base</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregate-several-new-documents-into-a-collection-from-a-data-base">Aggregate several new documents into a collection from a data base</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#number-of-documents-in-a-collection">Number of documents in a collection</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#remove-a-collection">Remove a collection</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering-documents-in-a-collection">Filtering documents in a collection</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting">Sorting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#remove-documents-from-a-collection">Remove documents from a collection</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#update-a-document">Update a document</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quering-radar-tickets-db">Quering Radar Tickets DB</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query-1"><strong>Query 1</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query-2">Query 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query-3">Query 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query-4">Query 4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query-5">Query 5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query-6">Query 6</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="intro-to-mongdb-nosql">
<h1>Intro to MongDB (NoSQL)<a class="headerlink" href="#intro-to-mongdb-nosql" title="Link to this heading">#</a></h1>
<section id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pymongo</span> <span class="kn">import</span> <span class="n">MongoClient</span>
<span class="kn">from</span> <span class="nn">pymongo</span> <span class="kn">import</span> <span class="n">ASCENDING</span><span class="p">,</span> <span class="n">DESCENDING</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">client</span> <span class="o">=</span> <span class="n">MongoClient</span><span class="p">(</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">27017</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="see-your-data-bases">
<h2>See your data bases<a class="headerlink" href="#see-your-data-bases" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">.</span><span class="n">list_database_names</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;admin&#39;,
 &#39;config&#39;,
 &#39;local&#39;,
 &#39;my_database&#39;,
 &#39;radar_tickets_db&#39;,
 &#39;task_back_end&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="remove-a-data-base">
<h2>Remove a data base<a class="headerlink" href="#remove-a-data-base" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># client.drop_database(&#39;my_database&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">.</span><span class="n">list_database_names</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;admin&#39;,
 &#39;config&#39;,
 &#39;local&#39;,
 &#39;my_database&#39;,
 &#39;radar_tickets_db&#39;,
 &#39;task_back_end&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-a-new-data-base">
<h2>Create a new data base<a class="headerlink" href="#create-a-new-data-base" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">database_1</span> <span class="o">=</span> <span class="n">client</span><span class="p">[</span><span class="s1">&#39;my_database&#39;</span><span class="p">]</span> 
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-a-new-collection-in-the-data-base">
<h2>Create a new collection in the data base<a class="headerlink" href="#create-a-new-collection-in-the-data-base" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection_1</span> <span class="o">=</span> <span class="n">database_1</span><span class="p">[</span><span class="s1">&#39;people&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="aggregate-a-new-document-into-a-collection-from-a-data-base">
<h2>Aggregate a new document into a collection from a data base<a class="headerlink" href="#aggregate-a-new-document-into-a-collection-from-a-data-base" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection_1</span><span class="o">.</span><span class="n">insert_one</span><span class="p">({</span><span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;Pepe&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span> <span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span> <span class="p">:</span> <span class="mf">1.85</span><span class="p">,</span> <span class="s1">&#39;studies&#39;</span> <span class="p">:</span> <span class="s1">&#39;civil engineer&#39;</span><span class="p">,</span> <span class="s1">&#39;country&#39;</span> <span class="p">:</span> <span class="s1">&#39;Spain&#39;</span><span class="p">,</span> <span class="s1">&#39;city&#39;</span> <span class="p">:</span> <span class="s1">&#39;Madrid&#39;</span><span class="p">,</span> <span class="s1">&#39;hobbies&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;music&#39;</span><span class="p">,</span> <span class="s1">&#39;football&#39;</span><span class="p">,</span> <span class="s1">&#39;reading&#39;</span><span class="p">]})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pymongo.results.InsertOneResult at 0x173712f2a10&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="aggregate-several-new-documents-into-a-collection-from-a-data-base">
<h2>Aggregate several new documents into a collection from a data base<a class="headerlink" href="#aggregate-several-new-documents-into-a-collection-from-a-data-base" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection_1</span><span class="o">.</span><span class="n">insert_many</span><span class="p">([{</span><span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;Juan&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span> <span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span> <span class="p">:</span> <span class="mf">1.7</span><span class="p">,</span> <span class="s1">&#39;studies&#39;</span> <span class="p">:</span> <span class="s1">&#39;industrial engineer&#39;</span><span class="p">,</span> <span class="s1">&#39;country&#39;</span> <span class="p">:</span> <span class="s1">&#39;Spain&#39;</span><span class="p">,</span> <span class="s1">&#39;city&#39;</span> <span class="p">:</span> <span class="s1">&#39;Toledo&#39;</span><span class="p">,</span> <span class="s1">&#39;hobbies&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;youtube&#39;</span><span class="p">]},</span>
                          <span class="p">{</span><span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;Lucia&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span> <span class="p">:</span> <span class="mi">32</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span> <span class="p">:</span> <span class="mf">1.63</span><span class="p">,</span> <span class="s1">&#39;studies&#39;</span> <span class="p">:</span> <span class="s1">&#39;psychologist&#39;</span><span class="p">,</span> <span class="s1">&#39;country&#39;</span> <span class="p">:</span> <span class="s1">&#39;Spain&#39;</span><span class="p">,</span> <span class="s1">&#39;city&#39;</span> <span class="p">:</span> <span class="s1">&#39;Madrid&#39;</span><span class="p">,</span> <span class="s1">&#39;hobbies&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;techno&#39;</span><span class="p">,</span> <span class="s1">&#39;parties&#39;</span><span class="p">]},</span>
                          <span class="p">{</span><span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;Garazi&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span> <span class="p">:</span> <span class="mi">45</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span> <span class="p">:</span> <span class="mf">1.55</span><span class="p">,</span> <span class="s1">&#39;studies&#39;</span> <span class="p">:</span> <span class="s1">&#39;nurse&#39;</span><span class="p">,</span> <span class="s1">&#39;country&#39;</span> <span class="p">:</span> <span class="s1">&#39;Spain&#39;</span><span class="p">,</span> <span class="s1">&#39;city&#39;</span> <span class="p">:</span> <span class="s1">&#39;Pais Vasco&#39;</span><span class="p">,</span> <span class="s1">&#39;hobbies&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;music&#39;</span><span class="p">,</span> <span class="s1">&#39;shopping&#39;</span><span class="p">,</span> <span class="s1">&#39;hospitals&#39;</span><span class="p">]},</span>
                          <span class="p">{</span><span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;Javi&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span> <span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span> <span class="p">:</span> <span class="mf">1.65</span><span class="p">,</span> <span class="s1">&#39;studies&#39;</span> <span class="p">:</span> <span class="s1">&#39;physician&#39;</span><span class="p">,</span> <span class="s1">&#39;country&#39;</span> <span class="p">:</span> <span class="s1">&#39;Spain&#39;</span><span class="p">,</span> <span class="s1">&#39;city&#39;</span> <span class="p">:</span> <span class="s1">&#39;Madrid&#39;</span><span class="p">,</span> <span class="s1">&#39;hobbies&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;music&#39;</span><span class="p">,</span> <span class="s1">&#39;basket&#39;</span><span class="p">,</span> <span class="s1">&#39;TV shows&#39;</span><span class="p">]},</span>
                          <span class="p">{</span><span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;Fabio&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span> <span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span> <span class="p">:</span> <span class="mf">1.75</span><span class="p">,</span> <span class="s1">&#39;studies&#39;</span> <span class="p">:</span> <span class="s1">&#39;statistician&#39;</span><span class="p">,</span> <span class="s1">&#39;country&#39;</span> <span class="p">:</span> <span class="s1">&#39;Spain&#39;</span><span class="p">,</span> <span class="s1">&#39;city&#39;</span> <span class="p">:</span> <span class="s1">&#39;Madrid&#39;</span><span class="p">,</span> <span class="s1">&#39;hobbies&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;music&#39;</span><span class="p">,</span> <span class="s1">&#39;football&#39;</span><span class="p">,</span> <span class="s1">&#39;programming&#39;</span><span class="p">]}])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pymongo.results.InsertManyResult at 0x173712bace0&gt;
</pre></div>
</div>
</div>
</div>
<p>To see the name of the collections that we have in our data base <code class="docutils literal notranslate"><span class="pre">my_database</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">database_1</span><span class="o">.</span><span class="n">list_collection_names</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;people&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="number-of-documents-in-a-collection">
<h2>Number of documents in a collection<a class="headerlink" href="#number-of-documents-in-a-collection" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection_1</span><span class="o">.</span><span class="n">count_documents</span><span class="p">({})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12
</pre></div>
</div>
</div>
</div>
</section>
<section id="remove-a-collection">
<h2>Remove a collection<a class="headerlink" href="#remove-a-collection" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># database_1.drop_collection(&#39;people&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">database_1</span><span class="o">.</span><span class="n">list_collection_names</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;people&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="filtering-documents-in-a-collection">
<h2>Filtering documents in a collection<a class="headerlink" href="#filtering-documents-in-a-collection" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>To see all the documents in a collection</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">collection_1</span><span class="o">.</span><span class="n">find</span><span class="p">({}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829aa&#39;),
  &#39;name&#39;: &#39;Pepe&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.85,
  &#39;studies&#39;: &#39;civil engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;reading&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ab&#39;),
  &#39;name&#39;: &#39;Juan&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.7,
  &#39;studies&#39;: &#39;industrial engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Toledo&#39;,
  &#39;hobbies&#39;: [&#39;youtube&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ac&#39;),
  &#39;name&#39;: &#39;Lucia&#39;,
  &#39;age&#39;: 32,
  &#39;height&#39;: 1.63,
  &#39;studies&#39;: &#39;psychologist&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;techno&#39;, &#39;parties&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ad&#39;),
  &#39;name&#39;: &#39;Garazi&#39;,
  &#39;age&#39;: 22,
  &#39;height&#39;: 1.51,
  &#39;studies&#39;: &#39;nurse&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Pais Vasco&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;shopping&#39;, &#39;hospitals&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ae&#39;),
  &#39;name&#39;: &#39;Javi&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.65,
  &#39;studies&#39;: &#39;physician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;basket&#39;, &#39;TV shows&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829af&#39;),
  &#39;name&#39;: &#39;Fabio&#39;,
  &#39;age&#39;: 22,
  &#39;height&#39;: 1.75,
  &#39;studies&#39;: &#39;statistician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;programming&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f89&#39;),
  &#39;name&#39;: &#39;Pepe&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.85,
  &#39;studies&#39;: &#39;civil engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;reading&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8a&#39;),
  &#39;name&#39;: &#39;Juan&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.7,
  &#39;studies&#39;: &#39;industrial engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Toledo&#39;,
  &#39;hobbies&#39;: [&#39;youtube&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8b&#39;),
  &#39;name&#39;: &#39;Lucia&#39;,
  &#39;age&#39;: 32,
  &#39;height&#39;: 1.63,
  &#39;studies&#39;: &#39;psychologist&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;techno&#39;, &#39;parties&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8c&#39;),
  &#39;name&#39;: &#39;Garazi&#39;,
  &#39;age&#39;: 45,
  &#39;height&#39;: 1.55,
  &#39;studies&#39;: &#39;nurse&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Pais Vasco&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;shopping&#39;, &#39;hospitals&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8d&#39;),
  &#39;name&#39;: &#39;Javi&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.65,
  &#39;studies&#39;: &#39;physician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;basket&#39;, &#39;TV shows&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8e&#39;),
  &#39;name&#39;: &#39;Fabio&#39;,
  &#39;age&#39;: 22,
  &#39;height&#39;: 1.75,
  &#39;studies&#39;: &#39;statistician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;programming&#39;]}]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Documents in the collection with age &gt; 30</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">collection_1</span><span class="o">.</span><span class="n">find</span><span class="p">({</span><span class="s1">&#39;age&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$gt&#39;</span> <span class="p">:</span> <span class="mi">30</span><span class="p">}}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ac&#39;),
  &#39;name&#39;: &#39;Lucia&#39;,
  &#39;age&#39;: 32,
  &#39;height&#39;: 1.63,
  &#39;studies&#39;: &#39;psychologist&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;techno&#39;, &#39;parties&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8b&#39;),
  &#39;name&#39;: &#39;Lucia&#39;,
  &#39;age&#39;: 32,
  &#39;height&#39;: 1.63,
  &#39;studies&#39;: &#39;psychologist&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;techno&#39;, &#39;parties&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8c&#39;),
  &#39;name&#39;: &#39;Garazi&#39;,
  &#39;age&#39;: 45,
  &#39;height&#39;: 1.55,
  &#39;studies&#39;: &#39;nurse&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Pais Vasco&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;shopping&#39;, &#39;hospitals&#39;]}]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>First document with age &gt; 30</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection_1</span><span class="o">.</span><span class="n">find_one</span><span class="p">({</span><span class="s1">&#39;age&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$gt&#39;</span> <span class="p">:</span> <span class="mi">30</span><span class="p">}})</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ac&#39;),
 &#39;name&#39;: &#39;Lucia&#39;,
 &#39;age&#39;: 32,
 &#39;height&#39;: 1.63,
 &#39;studies&#39;: &#39;psychologist&#39;,
 &#39;country&#39;: &#39;Spain&#39;,
 &#39;city&#39;: &#39;Madrid&#39;,
 &#39;hobbies&#39;: [&#39;techno&#39;, &#39;parties&#39;]}
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Documents  with age == 20</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">collection_1</span><span class="o">.</span><span class="n">find</span><span class="p">({</span><span class="s1">&#39;age&#39;</span> <span class="p">:</span> <span class="mi">20</span><span class="p">}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829aa&#39;),
  &#39;name&#39;: &#39;Pepe&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.85,
  &#39;studies&#39;: &#39;civil engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;reading&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ab&#39;),
  &#39;name&#39;: &#39;Juan&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.7,
  &#39;studies&#39;: &#39;industrial engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Toledo&#39;,
  &#39;hobbies&#39;: [&#39;youtube&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ae&#39;),
  &#39;name&#39;: &#39;Javi&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.65,
  &#39;studies&#39;: &#39;physician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;basket&#39;, &#39;TV shows&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f89&#39;),
  &#39;name&#39;: &#39;Pepe&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.85,
  &#39;studies&#39;: &#39;civil engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;reading&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8a&#39;),
  &#39;name&#39;: &#39;Juan&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.7,
  &#39;studies&#39;: &#39;industrial engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Toledo&#39;,
  &#39;hobbies&#39;: [&#39;youtube&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8d&#39;),
  &#39;name&#39;: &#39;Javi&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.65,
  &#39;studies&#39;: &#39;physician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;basket&#39;, &#39;TV shows&#39;]}]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Documents in the collection with age &lt; 30</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">collection_1</span><span class="o">.</span><span class="n">find</span><span class="p">({</span><span class="s1">&#39;age&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$lt&#39;</span> <span class="p">:</span> <span class="mi">30</span><span class="p">}}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829aa&#39;),
  &#39;name&#39;: &#39;Pepe&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.85,
  &#39;studies&#39;: &#39;civil engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;reading&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ab&#39;),
  &#39;name&#39;: &#39;Juan&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.7,
  &#39;studies&#39;: &#39;industrial engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Toledo&#39;,
  &#39;hobbies&#39;: [&#39;youtube&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ad&#39;),
  &#39;name&#39;: &#39;Garazi&#39;,
  &#39;age&#39;: 22,
  &#39;height&#39;: 1.51,
  &#39;studies&#39;: &#39;nurse&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Pais Vasco&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;shopping&#39;, &#39;hospitals&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ae&#39;),
  &#39;name&#39;: &#39;Javi&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.65,
  &#39;studies&#39;: &#39;physician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;basket&#39;, &#39;TV shows&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829af&#39;),
  &#39;name&#39;: &#39;Fabio&#39;,
  &#39;age&#39;: 22,
  &#39;height&#39;: 1.75,
  &#39;studies&#39;: &#39;statistician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;programming&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f89&#39;),
  &#39;name&#39;: &#39;Pepe&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.85,
  &#39;studies&#39;: &#39;civil engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;reading&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8a&#39;),
  &#39;name&#39;: &#39;Juan&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.7,
  &#39;studies&#39;: &#39;industrial engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Toledo&#39;,
  &#39;hobbies&#39;: [&#39;youtube&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8d&#39;),
  &#39;name&#39;: &#39;Javi&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.65,
  &#39;studies&#39;: &#39;physician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;basket&#39;, &#39;TV shows&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8e&#39;),
  &#39;name&#39;: &#39;Fabio&#39;,
  &#39;age&#39;: 22,
  &#39;height&#39;: 1.75,
  &#39;studies&#39;: &#39;statistician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;programming&#39;]}]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Documents in the collection with age &lt;= 32</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">collection_1</span><span class="o">.</span><span class="n">find</span><span class="p">({</span><span class="s1">&#39;age&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$lte&#39;</span> <span class="p">:</span> <span class="mi">32</span><span class="p">}}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829aa&#39;),
  &#39;name&#39;: &#39;Pepe&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.85,
  &#39;studies&#39;: &#39;civil engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;reading&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ab&#39;),
  &#39;name&#39;: &#39;Juan&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.7,
  &#39;studies&#39;: &#39;industrial engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Toledo&#39;,
  &#39;hobbies&#39;: [&#39;youtube&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ac&#39;),
  &#39;name&#39;: &#39;Lucia&#39;,
  &#39;age&#39;: 32,
  &#39;height&#39;: 1.63,
  &#39;studies&#39;: &#39;psychologist&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;techno&#39;, &#39;parties&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ad&#39;),
  &#39;name&#39;: &#39;Garazi&#39;,
  &#39;age&#39;: 22,
  &#39;height&#39;: 1.51,
  &#39;studies&#39;: &#39;nurse&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Pais Vasco&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;shopping&#39;, &#39;hospitals&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ae&#39;),
  &#39;name&#39;: &#39;Javi&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.65,
  &#39;studies&#39;: &#39;physician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;basket&#39;, &#39;TV shows&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829af&#39;),
  &#39;name&#39;: &#39;Fabio&#39;,
  &#39;age&#39;: 22,
  &#39;height&#39;: 1.75,
  &#39;studies&#39;: &#39;statistician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;programming&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f89&#39;),
  &#39;name&#39;: &#39;Pepe&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.85,
  &#39;studies&#39;: &#39;civil engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;reading&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8a&#39;),
  &#39;name&#39;: &#39;Juan&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.7,
  &#39;studies&#39;: &#39;industrial engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Toledo&#39;,
  &#39;hobbies&#39;: [&#39;youtube&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8b&#39;),
  &#39;name&#39;: &#39;Lucia&#39;,
  &#39;age&#39;: 32,
  &#39;height&#39;: 1.63,
  &#39;studies&#39;: &#39;psychologist&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;techno&#39;, &#39;parties&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8d&#39;),
  &#39;name&#39;: &#39;Javi&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.65,
  &#39;studies&#39;: &#39;physician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;basket&#39;, &#39;TV shows&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8e&#39;),
  &#39;name&#39;: &#39;Fabio&#39;,
  &#39;age&#39;: 22,
  &#39;height&#39;: 1.75,
  &#39;studies&#39;: &#39;statistician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;programming&#39;]}]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Documents in the collection with age &gt;= 32</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">collection_1</span><span class="o">.</span><span class="n">find</span><span class="p">({</span><span class="s1">&#39;age&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$gte&#39;</span> <span class="p">:</span> <span class="mi">32</span><span class="p">}}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ac&#39;),
  &#39;name&#39;: &#39;Lucia&#39;,
  &#39;age&#39;: 32,
  &#39;height&#39;: 1.63,
  &#39;studies&#39;: &#39;psychologist&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;techno&#39;, &#39;parties&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8b&#39;),
  &#39;name&#39;: &#39;Lucia&#39;,
  &#39;age&#39;: 32,
  &#39;height&#39;: 1.63,
  &#39;studies&#39;: &#39;psychologist&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;techno&#39;, &#39;parties&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8c&#39;),
  &#39;name&#39;: &#39;Garazi&#39;,
  &#39;age&#39;: 45,
  &#39;height&#39;: 1.55,
  &#39;studies&#39;: &#39;nurse&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Pais Vasco&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;shopping&#39;, &#39;hospitals&#39;]}]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Documents in the collection with age != 32</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">collection_1</span><span class="o">.</span><span class="n">find</span><span class="p">({</span><span class="s1">&#39;age&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$ne&#39;</span> <span class="p">:</span> <span class="mi">32</span><span class="p">}}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829aa&#39;),
  &#39;name&#39;: &#39;Pepe&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.85,
  &#39;studies&#39;: &#39;civil engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;reading&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ab&#39;),
  &#39;name&#39;: &#39;Juan&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.7,
  &#39;studies&#39;: &#39;industrial engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Toledo&#39;,
  &#39;hobbies&#39;: [&#39;youtube&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ad&#39;),
  &#39;name&#39;: &#39;Garazi&#39;,
  &#39;age&#39;: 22,
  &#39;height&#39;: 1.51,
  &#39;studies&#39;: &#39;nurse&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Pais Vasco&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;shopping&#39;, &#39;hospitals&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ae&#39;),
  &#39;name&#39;: &#39;Javi&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.65,
  &#39;studies&#39;: &#39;physician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;basket&#39;, &#39;TV shows&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829af&#39;),
  &#39;name&#39;: &#39;Fabio&#39;,
  &#39;age&#39;: 22,
  &#39;height&#39;: 1.75,
  &#39;studies&#39;: &#39;statistician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;programming&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f89&#39;),
  &#39;name&#39;: &#39;Pepe&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.85,
  &#39;studies&#39;: &#39;civil engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;reading&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8a&#39;),
  &#39;name&#39;: &#39;Juan&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.7,
  &#39;studies&#39;: &#39;industrial engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Toledo&#39;,
  &#39;hobbies&#39;: [&#39;youtube&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8c&#39;),
  &#39;name&#39;: &#39;Garazi&#39;,
  &#39;age&#39;: 45,
  &#39;height&#39;: 1.55,
  &#39;studies&#39;: &#39;nurse&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Pais Vasco&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;shopping&#39;, &#39;hospitals&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8d&#39;),
  &#39;name&#39;: &#39;Javi&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.65,
  &#39;studies&#39;: &#39;physician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;basket&#39;, &#39;TV shows&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8e&#39;),
  &#39;name&#39;: &#39;Fabio&#39;,
  &#39;age&#39;: 22,
  &#39;height&#39;: 1.75,
  &#39;studies&#39;: &#39;statistician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;programming&#39;]}]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Documents in the collection with age &gt;= 32 and city == Madrid</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">collection_1</span><span class="o">.</span><span class="n">find</span><span class="p">({</span><span class="s1">&#39;age&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$gte&#39;</span> <span class="p">:</span> <span class="mi">30</span><span class="p">},</span> <span class="s1">&#39;city&#39;</span> <span class="p">:</span> <span class="s1">&#39;Madrid&#39;</span><span class="p">}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ac&#39;),
  &#39;name&#39;: &#39;Lucia&#39;,
  &#39;age&#39;: 32,
  &#39;height&#39;: 1.63,
  &#39;studies&#39;: &#39;psychologist&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;techno&#39;, &#39;parties&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8b&#39;),
  &#39;name&#39;: &#39;Lucia&#39;,
  &#39;age&#39;: 32,
  &#39;height&#39;: 1.63,
  &#39;studies&#39;: &#39;psychologist&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;techno&#39;, &#39;parties&#39;]}]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Documents in the collection with age &gt; 40 or city == Toledo</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">collection_1</span><span class="o">.</span><span class="n">find</span><span class="p">({</span><span class="s1">&#39;$or&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$gte&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">}},</span> <span class="p">{</span><span class="s1">&#39;city&#39;</span><span class="p">:</span> <span class="s1">&#39;Toledo&#39;</span><span class="p">}]}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ab&#39;),
  &#39;name&#39;: &#39;Juan&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.7,
  &#39;studies&#39;: &#39;industrial engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Toledo&#39;,
  &#39;hobbies&#39;: [&#39;youtube&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ac&#39;),
  &#39;name&#39;: &#39;Lucia&#39;,
  &#39;age&#39;: 32,
  &#39;height&#39;: 1.63,
  &#39;studies&#39;: &#39;psychologist&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;techno&#39;, &#39;parties&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8a&#39;),
  &#39;name&#39;: &#39;Juan&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.7,
  &#39;studies&#39;: &#39;industrial engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Toledo&#39;,
  &#39;hobbies&#39;: [&#39;youtube&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8b&#39;),
  &#39;name&#39;: &#39;Lucia&#39;,
  &#39;age&#39;: 32,
  &#39;height&#39;: 1.63,
  &#39;studies&#39;: &#39;psychologist&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;techno&#39;, &#39;parties&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8c&#39;),
  &#39;name&#39;: &#39;Garazi&#39;,
  &#39;age&#39;: 45,
  &#39;height&#39;: 1.55,
  &#39;studies&#39;: &#39;nurse&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Pais Vasco&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;shopping&#39;, &#39;hospitals&#39;]}]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Documents in the collection with football in hobbies list</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">collection_1</span><span class="o">.</span><span class="n">find</span><span class="p">({</span><span class="s1">&#39;hobbies&#39;</span><span class="p">:</span> <span class="s1">&#39;football&#39;</span><span class="p">}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829aa&#39;),
  &#39;name&#39;: &#39;Pepe&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.85,
  &#39;studies&#39;: &#39;civil engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;reading&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829af&#39;),
  &#39;name&#39;: &#39;Fabio&#39;,
  &#39;age&#39;: 22,
  &#39;height&#39;: 1.75,
  &#39;studies&#39;: &#39;statistician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;programming&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f89&#39;),
  &#39;name&#39;: &#39;Pepe&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.85,
  &#39;studies&#39;: &#39;civil engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;reading&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8e&#39;),
  &#39;name&#39;: &#39;Fabio&#39;,
  &#39;age&#39;: 22,
  &#39;height&#39;: 1.75,
  &#39;studies&#39;: &#39;statistician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;programming&#39;]}]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>documents with (age &gt;= 30 and city == Madrid) or (height &lt;= 1.75 and age &lt; 25)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;$or&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;$and&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$gte&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">}},</span> <span class="p">{</span><span class="s1">&#39;city&#39;</span><span class="p">:</span> <span class="s1">&#39;Madrid&#39;</span><span class="p">}]},</span> <span class="p">{</span><span class="s1">&#39;$and&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$lt&#39;</span><span class="p">:</span> <span class="mf">1.75</span><span class="p">}},</span> <span class="p">{</span><span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$lt&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">}}]}]}</span>

<span class="nb">list</span><span class="p">(</span><span class="n">collection_1</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">query</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ab&#39;),
  &#39;name&#39;: &#39;Juan&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.7,
  &#39;studies&#39;: &#39;industrial engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Toledo&#39;,
  &#39;hobbies&#39;: [&#39;youtube&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ac&#39;),
  &#39;name&#39;: &#39;Lucia&#39;,
  &#39;age&#39;: 32,
  &#39;height&#39;: 1.63,
  &#39;studies&#39;: &#39;psychologist&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;techno&#39;, &#39;parties&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ad&#39;),
  &#39;name&#39;: &#39;Garazi&#39;,
  &#39;age&#39;: 22,
  &#39;height&#39;: 1.51,
  &#39;studies&#39;: &#39;nurse&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Pais Vasco&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;shopping&#39;, &#39;hospitals&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ae&#39;),
  &#39;name&#39;: &#39;Javi&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.65,
  &#39;studies&#39;: &#39;physician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;basket&#39;, &#39;TV shows&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8a&#39;),
  &#39;name&#39;: &#39;Juan&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.7,
  &#39;studies&#39;: &#39;industrial engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Toledo&#39;,
  &#39;hobbies&#39;: [&#39;youtube&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8b&#39;),
  &#39;name&#39;: &#39;Lucia&#39;,
  &#39;age&#39;: 32,
  &#39;height&#39;: 1.63,
  &#39;studies&#39;: &#39;psychologist&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;techno&#39;, &#39;parties&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8d&#39;),
  &#39;name&#39;: &#39;Javi&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.65,
  &#39;studies&#39;: &#39;physician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;basket&#39;, &#39;TV shows&#39;]}]
</pre></div>
</div>
</div>
</div>
</section>
<section id="sorting">
<h2>Sorting<a class="headerlink" href="#sorting" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;$or&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;$and&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$gte&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">}},</span> <span class="p">{</span><span class="s1">&#39;city&#39;</span><span class="p">:</span> <span class="s1">&#39;Madrid&#39;</span><span class="p">}]},</span> <span class="p">{</span><span class="s1">&#39;$and&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$lt&#39;</span><span class="p">:</span> <span class="mf">1.75</span><span class="p">}},</span> <span class="p">{</span><span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$lt&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">}}]}]}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">collection_1</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">query</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ad&#39;),
  &#39;name&#39;: &#39;Garazi&#39;,
  &#39;age&#39;: 22,
  &#39;height&#39;: 1.51,
  &#39;studies&#39;: &#39;nurse&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Pais Vasco&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;shopping&#39;, &#39;hospitals&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ac&#39;),
  &#39;name&#39;: &#39;Lucia&#39;,
  &#39;age&#39;: 32,
  &#39;height&#39;: 1.63,
  &#39;studies&#39;: &#39;psychologist&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;techno&#39;, &#39;parties&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8b&#39;),
  &#39;name&#39;: &#39;Lucia&#39;,
  &#39;age&#39;: 32,
  &#39;height&#39;: 1.63,
  &#39;studies&#39;: &#39;psychologist&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;techno&#39;, &#39;parties&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ae&#39;),
  &#39;name&#39;: &#39;Javi&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.65,
  &#39;studies&#39;: &#39;physician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;basket&#39;, &#39;TV shows&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8d&#39;),
  &#39;name&#39;: &#39;Javi&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.65,
  &#39;studies&#39;: &#39;physician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;basket&#39;, &#39;TV shows&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ab&#39;),
  &#39;name&#39;: &#39;Juan&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.7,
  &#39;studies&#39;: &#39;industrial engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Toledo&#39;,
  &#39;hobbies&#39;: [&#39;youtube&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8a&#39;),
  &#39;name&#39;: &#39;Juan&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.7,
  &#39;studies&#39;: &#39;industrial engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Toledo&#39;,
  &#39;hobbies&#39;: [&#39;youtube&#39;]}]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">collection_1</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">query</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ab&#39;),
  &#39;name&#39;: &#39;Juan&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.7,
  &#39;studies&#39;: &#39;industrial engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Toledo&#39;,
  &#39;hobbies&#39;: [&#39;youtube&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8a&#39;),
  &#39;name&#39;: &#39;Juan&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.7,
  &#39;studies&#39;: &#39;industrial engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Toledo&#39;,
  &#39;hobbies&#39;: [&#39;youtube&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ae&#39;),
  &#39;name&#39;: &#39;Javi&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.65,
  &#39;studies&#39;: &#39;physician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;basket&#39;, &#39;TV shows&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8d&#39;),
  &#39;name&#39;: &#39;Javi&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.65,
  &#39;studies&#39;: &#39;physician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;basket&#39;, &#39;TV shows&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ac&#39;),
  &#39;name&#39;: &#39;Lucia&#39;,
  &#39;age&#39;: 32,
  &#39;height&#39;: 1.63,
  &#39;studies&#39;: &#39;psychologist&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;techno&#39;, &#39;parties&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8b&#39;),
  &#39;name&#39;: &#39;Lucia&#39;,
  &#39;age&#39;: 32,
  &#39;height&#39;: 1.63,
  &#39;studies&#39;: &#39;psychologist&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;techno&#39;, &#39;parties&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ad&#39;),
  &#39;name&#39;: &#39;Garazi&#39;,
  &#39;age&#39;: 22,
  &#39;height&#39;: 1.51,
  &#39;studies&#39;: &#39;nurse&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Pais Vasco&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;shopping&#39;, &#39;hospitals&#39;]}]
</pre></div>
</div>
</div>
</div>
</section>
<section id="remove-documents-from-a-collection">
<h2>Remove documents from a collection<a class="headerlink" href="#remove-documents-from-a-collection" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Delete the first documents with age == 20</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection_1</span><span class="o">.</span><span class="n">delete_one</span><span class="p">({</span><span class="s1">&#39;age&#39;</span> <span class="p">:</span> <span class="mi">20</span><span class="p">})</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pymongo.results.DeleteResult at 0x173713cb970&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">collection_1</span><span class="o">.</span><span class="n">find</span><span class="p">({}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ab&#39;),
  &#39;name&#39;: &#39;Juan&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.7,
  &#39;studies&#39;: &#39;industrial engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Toledo&#39;,
  &#39;hobbies&#39;: [&#39;youtube&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ac&#39;),
  &#39;name&#39;: &#39;Lucia&#39;,
  &#39;age&#39;: 32,
  &#39;height&#39;: 1.63,
  &#39;studies&#39;: &#39;psychologist&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;techno&#39;, &#39;parties&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ad&#39;),
  &#39;name&#39;: &#39;Garazi&#39;,
  &#39;age&#39;: 22,
  &#39;height&#39;: 1.51,
  &#39;studies&#39;: &#39;nurse&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Pais Vasco&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;shopping&#39;, &#39;hospitals&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ae&#39;),
  &#39;name&#39;: &#39;Javi&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.65,
  &#39;studies&#39;: &#39;physician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;basket&#39;, &#39;TV shows&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829af&#39;),
  &#39;name&#39;: &#39;Fabio&#39;,
  &#39;age&#39;: 22,
  &#39;height&#39;: 1.75,
  &#39;studies&#39;: &#39;statistician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;programming&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f89&#39;),
  &#39;name&#39;: &#39;Pepe&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.85,
  &#39;studies&#39;: &#39;civil engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;reading&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8a&#39;),
  &#39;name&#39;: &#39;Juan&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.7,
  &#39;studies&#39;: &#39;industrial engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Toledo&#39;,
  &#39;hobbies&#39;: [&#39;youtube&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8b&#39;),
  &#39;name&#39;: &#39;Lucia&#39;,
  &#39;age&#39;: 32,
  &#39;height&#39;: 1.63,
  &#39;studies&#39;: &#39;psychologist&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;techno&#39;, &#39;parties&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8c&#39;),
  &#39;name&#39;: &#39;Garazi&#39;,
  &#39;age&#39;: 45,
  &#39;height&#39;: 1.55,
  &#39;studies&#39;: &#39;nurse&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Pais Vasco&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;shopping&#39;, &#39;hospitals&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8d&#39;),
  &#39;name&#39;: &#39;Javi&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.65,
  &#39;studies&#39;: &#39;physician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;basket&#39;, &#39;TV shows&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8e&#39;),
  &#39;name&#39;: &#39;Fabio&#39;,
  &#39;age&#39;: 22,
  &#39;height&#39;: 1.75,
  &#39;studies&#39;: &#39;statistician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;programming&#39;]}]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Delete all the documents with age == 20</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection_1</span><span class="o">.</span><span class="n">delete_many</span><span class="p">({</span><span class="s1">&#39;age&#39;</span> <span class="p">:</span> <span class="mi">20</span><span class="p">})</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pymongo.results.DeleteResult at 0x173715223b0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">collection_1</span><span class="o">.</span><span class="n">find</span><span class="p">({}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ac&#39;),
  &#39;name&#39;: &#39;Lucia&#39;,
  &#39;age&#39;: 32,
  &#39;height&#39;: 1.63,
  &#39;studies&#39;: &#39;psychologist&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;techno&#39;, &#39;parties&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829ad&#39;),
  &#39;name&#39;: &#39;Garazi&#39;,
  &#39;age&#39;: 22,
  &#39;height&#39;: 1.51,
  &#39;studies&#39;: &#39;nurse&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Pais Vasco&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;shopping&#39;, &#39;hospitals&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;65414306574841bdc85829af&#39;),
  &#39;name&#39;: &#39;Fabio&#39;,
  &#39;age&#39;: 22,
  &#39;height&#39;: 1.75,
  &#39;studies&#39;: &#39;statistician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;programming&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8b&#39;),
  &#39;name&#39;: &#39;Lucia&#39;,
  &#39;age&#39;: 32,
  &#39;height&#39;: 1.63,
  &#39;studies&#39;: &#39;psychologist&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;techno&#39;, &#39;parties&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8c&#39;),
  &#39;name&#39;: &#39;Garazi&#39;,
  &#39;age&#39;: 45,
  &#39;height&#39;: 1.55,
  &#39;studies&#39;: &#39;nurse&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Pais Vasco&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;shopping&#39;, &#39;hospitals&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8e&#39;),
  &#39;name&#39;: &#39;Fabio&#39;,
  &#39;age&#39;: 22,
  &#39;height&#39;: 1.75,
  &#39;studies&#39;: &#39;statistician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;programming&#39;]}]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Delete all the documents</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection_1</span><span class="o">.</span><span class="n">delete_many</span><span class="p">({})</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pymongo.results.DeleteResult at 0x173713cbdc0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">collection_1</span><span class="o">.</span><span class="n">find</span><span class="p">({}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Restarting the original collection</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection_1</span><span class="o">.</span><span class="n">insert_many</span><span class="p">([{</span><span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;Pepe&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span> <span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span> <span class="p">:</span> <span class="mf">1.85</span><span class="p">,</span> <span class="s1">&#39;studies&#39;</span> <span class="p">:</span> <span class="s1">&#39;civil engineer&#39;</span><span class="p">,</span> <span class="s1">&#39;country&#39;</span> <span class="p">:</span> <span class="s1">&#39;Spain&#39;</span><span class="p">,</span> <span class="s1">&#39;city&#39;</span> <span class="p">:</span> <span class="s1">&#39;Madrid&#39;</span><span class="p">,</span> <span class="s1">&#39;hobbies&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;music&#39;</span><span class="p">,</span> <span class="s1">&#39;football&#39;</span><span class="p">,</span> <span class="s1">&#39;reading&#39;</span><span class="p">]},</span>
                          <span class="p">{</span><span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;Juan&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span> <span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span> <span class="p">:</span> <span class="mf">1.7</span><span class="p">,</span> <span class="s1">&#39;studies&#39;</span> <span class="p">:</span> <span class="s1">&#39;industrial engineer&#39;</span><span class="p">,</span> <span class="s1">&#39;country&#39;</span> <span class="p">:</span> <span class="s1">&#39;Spain&#39;</span><span class="p">,</span> <span class="s1">&#39;city&#39;</span> <span class="p">:</span> <span class="s1">&#39;Toledo&#39;</span><span class="p">,</span> <span class="s1">&#39;hobbies&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;youtube&#39;</span><span class="p">]},</span>
                          <span class="p">{</span><span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;Lucia&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span> <span class="p">:</span> <span class="mi">32</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span> <span class="p">:</span> <span class="mf">1.63</span><span class="p">,</span> <span class="s1">&#39;studies&#39;</span> <span class="p">:</span> <span class="s1">&#39;psychologist&#39;</span><span class="p">,</span> <span class="s1">&#39;country&#39;</span> <span class="p">:</span> <span class="s1">&#39;Spain&#39;</span><span class="p">,</span> <span class="s1">&#39;city&#39;</span> <span class="p">:</span> <span class="s1">&#39;Madrid&#39;</span><span class="p">,</span> <span class="s1">&#39;hobbies&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;techno&#39;</span><span class="p">,</span> <span class="s1">&#39;parties&#39;</span><span class="p">]},</span>
                          <span class="p">{</span><span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;Garazi&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span> <span class="p">:</span> <span class="mi">45</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span> <span class="p">:</span> <span class="mf">1.55</span><span class="p">,</span> <span class="s1">&#39;studies&#39;</span> <span class="p">:</span> <span class="s1">&#39;nurse&#39;</span><span class="p">,</span> <span class="s1">&#39;country&#39;</span> <span class="p">:</span> <span class="s1">&#39;Spain&#39;</span><span class="p">,</span> <span class="s1">&#39;city&#39;</span> <span class="p">:</span> <span class="s1">&#39;Pais Vasco&#39;</span><span class="p">,</span> <span class="s1">&#39;hobbies&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;music&#39;</span><span class="p">,</span> <span class="s1">&#39;shopping&#39;</span><span class="p">,</span> <span class="s1">&#39;hospitals&#39;</span><span class="p">]},</span>
                          <span class="p">{</span><span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;Javi&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span> <span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span> <span class="p">:</span> <span class="mf">1.65</span><span class="p">,</span> <span class="s1">&#39;studies&#39;</span> <span class="p">:</span> <span class="s1">&#39;physician&#39;</span><span class="p">,</span> <span class="s1">&#39;country&#39;</span> <span class="p">:</span> <span class="s1">&#39;Spain&#39;</span><span class="p">,</span> <span class="s1">&#39;city&#39;</span> <span class="p">:</span> <span class="s1">&#39;Madrid&#39;</span><span class="p">,</span> <span class="s1">&#39;hobbies&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;music&#39;</span><span class="p">,</span> <span class="s1">&#39;basket&#39;</span><span class="p">,</span> <span class="s1">&#39;TV shows&#39;</span><span class="p">]},</span>
                          <span class="p">{</span><span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;Fabio&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span> <span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span> <span class="p">:</span> <span class="mf">1.75</span><span class="p">,</span> <span class="s1">&#39;studies&#39;</span> <span class="p">:</span> <span class="s1">&#39;statistician&#39;</span><span class="p">,</span> <span class="s1">&#39;country&#39;</span> <span class="p">:</span> <span class="s1">&#39;Spain&#39;</span><span class="p">,</span> <span class="s1">&#39;city&#39;</span> <span class="p">:</span> <span class="s1">&#39;Madrid&#39;</span><span class="p">,</span> <span class="s1">&#39;hobbies&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;music&#39;</span><span class="p">,</span> <span class="s1">&#39;football&#39;</span><span class="p">,</span> <span class="s1">&#39;programming&#39;</span><span class="p">]}])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pymongo.results.InsertManyResult at 0x17371537eb0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">collection_1</span><span class="o">.</span><span class="n">find</span><span class="p">({}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8f&#39;),
  &#39;name&#39;: &#39;Pepe&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.85,
  &#39;studies&#39;: &#39;civil engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;reading&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f90&#39;),
  &#39;name&#39;: &#39;Juan&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.7,
  &#39;studies&#39;: &#39;industrial engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Toledo&#39;,
  &#39;hobbies&#39;: [&#39;youtube&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f91&#39;),
  &#39;name&#39;: &#39;Lucia&#39;,
  &#39;age&#39;: 32,
  &#39;height&#39;: 1.63,
  &#39;studies&#39;: &#39;psychologist&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;techno&#39;, &#39;parties&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f92&#39;),
  &#39;name&#39;: &#39;Garazi&#39;,
  &#39;age&#39;: 45,
  &#39;height&#39;: 1.55,
  &#39;studies&#39;: &#39;nurse&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Pais Vasco&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;shopping&#39;, &#39;hospitals&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f93&#39;),
  &#39;name&#39;: &#39;Javi&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.65,
  &#39;studies&#39;: &#39;physician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;basket&#39;, &#39;TV shows&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f94&#39;),
  &#39;name&#39;: &#39;Fabio&#39;,
  &#39;age&#39;: 22,
  &#39;height&#39;: 1.75,
  &#39;studies&#39;: &#39;statistician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;programming&#39;]}]
</pre></div>
</div>
</div>
</div>
</section>
<section id="update-a-document">
<h2>Update a document<a class="headerlink" href="#update-a-document" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection_1</span><span class="o">.</span><span class="n">update_one</span><span class="p">({</span><span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;Garazi&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;$set&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;age&#39;</span> <span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span> <span class="p">:</span> <span class="mf">1.51</span><span class="p">}})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pymongo.results.UpdateResult at 0x17371500940&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">collection_1</span><span class="o">.</span><span class="n">find</span><span class="p">({}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f8f&#39;),
  &#39;name&#39;: &#39;Pepe&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.85,
  &#39;studies&#39;: &#39;civil engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;reading&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f90&#39;),
  &#39;name&#39;: &#39;Juan&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.7,
  &#39;studies&#39;: &#39;industrial engineer&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Toledo&#39;,
  &#39;hobbies&#39;: [&#39;youtube&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f91&#39;),
  &#39;name&#39;: &#39;Lucia&#39;,
  &#39;age&#39;: 32,
  &#39;height&#39;: 1.63,
  &#39;studies&#39;: &#39;psychologist&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;techno&#39;, &#39;parties&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f92&#39;),
  &#39;name&#39;: &#39;Garazi&#39;,
  &#39;age&#39;: 22,
  &#39;height&#39;: 1.51,
  &#39;studies&#39;: &#39;nurse&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Pais Vasco&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;shopping&#39;, &#39;hospitals&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f93&#39;),
  &#39;name&#39;: &#39;Javi&#39;,
  &#39;age&#39;: 20,
  &#39;height&#39;: 1.65,
  &#39;studies&#39;: &#39;physician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;basket&#39;, &#39;TV shows&#39;]},
 {&#39;_id&#39;: ObjectId(&#39;6574a37ccb773873c6907f94&#39;),
  &#39;name&#39;: &#39;Fabio&#39;,
  &#39;age&#39;: 22,
  &#39;height&#39;: 1.75,
  &#39;studies&#39;: &#39;statistician&#39;,
  &#39;country&#39;: &#39;Spain&#39;,
  &#39;city&#39;: &#39;Madrid&#39;,
  &#39;hobbies&#39;: [&#39;music&#39;, &#39;football&#39;, &#39;programming&#39;]}]
</pre></div>
</div>
</div>
</div>
</section>
<section id="quering-radar-tickets-db">
<h2>Quering Radar Tickets DB<a class="headerlink" href="#quering-radar-tickets-db" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">.</span><span class="n">drop_database</span><span class="p">(</span><span class="s1">&#39;radar_tickets_db&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Create a new database with a collection to work in.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">radar_tickets_db</span> <span class="o">=</span> <span class="n">client</span><span class="p">[</span><span class="s1">&#39;radar_tickets_db&#39;</span><span class="p">]</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">radar_tickets_collection</span> <span class="o">=</span> <span class="n">radar_tickets_db</span><span class="p">[</span><span class="s1">&#39;radar_tickets_collection&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>We load the json file that contains the collection with which we will work.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;C:\Users\fscielzo\Documents\Large-Data\radar_tickets.json&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">radar_tickets</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">JSONDecodeError</span><span class="g g-Whitespace">                           </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">46</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;C:\Users\fscielzo\Documents\Large-Data\radar_tickets.json&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
<span class="ne">----&gt; </span><span class="mi">2</span>     <span class="n">radar_tickets</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

<span class="nn">File c:\Users\fscielzo\AppData\Local\Programs\Python\Python312\Lib\json\__init__.py:293,</span> in <span class="ni">load</span><span class="nt">(fp, cls, object_hook, parse_float, parse_int, parse_constant, object_pairs_hook, **kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">274</span> <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">object_hook</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parse_float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">275</span>         <span class="n">parse_int</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parse_constant</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">object_pairs_hook</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">276</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Deserialize ``fp`` (a ``.read()``-supporting file-like object containing</span>
<span class="g g-Whitespace">    </span><span class="mi">277</span><span class="sd">     a JSON document) to a Python object.</span>
<span class="g g-Whitespace">    </span><span class="mi">278</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">291</span><span class="sd">     kwarg; otherwise ``JSONDecoder`` is used.</span>
<span class="g g-Whitespace">    </span><span class="mi">292</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">293</span>     <span class="k">return</span> <span class="n">loads</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span>
<span class="g g-Whitespace">    </span><span class="mi">294</span>         <span class="bp">cls</span><span class="o">=</span><span class="bp">cls</span><span class="p">,</span> <span class="n">object_hook</span><span class="o">=</span><span class="n">object_hook</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">295</span>         <span class="n">parse_float</span><span class="o">=</span><span class="n">parse_float</span><span class="p">,</span> <span class="n">parse_int</span><span class="o">=</span><span class="n">parse_int</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">296</span>         <span class="n">parse_constant</span><span class="o">=</span><span class="n">parse_constant</span><span class="p">,</span> <span class="n">object_pairs_hook</span><span class="o">=</span><span class="n">object_pairs_hook</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

<span class="nn">File c:\Users\fscielzo\AppData\Local\Programs\Python\Python312\Lib\json\__init__.py:346,</span> in <span class="ni">loads</span><span class="nt">(s, cls, object_hook, parse_float, parse_int, parse_constant, object_pairs_hook, **kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">341</span>     <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">detect_encoding</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="s1">&#39;surrogatepass&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">343</span> <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">object_hook</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span>
<span class="g g-Whitespace">    </span><span class="mi">344</span>         <span class="n">parse_int</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">parse_float</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span>
<span class="g g-Whitespace">    </span><span class="mi">345</span>         <span class="n">parse_constant</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">object_pairs_hook</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">kw</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">346</span>     <span class="k">return</span> <span class="n">_default_decoder</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">347</span> <span class="k">if</span> <span class="bp">cls</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">348</span>     <span class="bp">cls</span> <span class="o">=</span> <span class="n">JSONDecoder</span>

<span class="nn">File c:\Users\fscielzo\AppData\Local\Programs\Python\Python312\Lib\json\decoder.py:340,</span> in <span class="ni">JSONDecoder.decode</span><span class="nt">(self, s, _w)</span>
<span class="g g-Whitespace">    </span><span class="mi">338</span> <span class="n">end</span> <span class="o">=</span> <span class="n">_w</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">339</span> <span class="k">if</span> <span class="n">end</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">340</span>     <span class="k">raise</span> <span class="n">JSONDecodeError</span><span class="p">(</span><span class="s2">&quot;Extra data&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">341</span> <span class="k">return</span> <span class="n">obj</span>

<span class="ne">JSONDecodeError</span>: Extra data: line 58 column 1 (char 2329)
</pre></div>
</div>
</div>
</div>
<p>The problem that we are encountering is due to the lack of commas between the documents (whole dictionaries) contained in the file <code class="docutils literal notranslate"><span class="pre">radar_tickets.json</span></code>.</p>
<p>To overcome this problem we have to insert commas in that positions. As there are 500000 documents in the file, we cannot do it manually, so, we are going to automate the task.</p>
<ul>
<li><p>First: save the radar_tickets.json file as a text file (.txt).</p>
<p>This can be done easily from vs code left bar. Just make a copy of radar_tickets.json and rename it as radar_tickets.txt.</p>
</li>
</ul>
<ul class="simple">
<li><p>Second: open the text file radar_tickets.txt</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">txt_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;C:\Users\fscielzo\Documents\Large-Data\radar_tickets.txt&quot;</span><span class="p">)</span>
<span class="n">txt_file</span> <span class="o">=</span> <span class="n">txt_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Third: split the text txt_file by the string ‘{ \n  “_id”’ and store it in a new variable (splits).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">splits</span> <span class="o">=</span> <span class="n">txt_file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;{ </span><span class="se">\n</span><span class="s1">  &quot;_id&quot;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Fourth: reconstruct the documents, by adding ‘{ \n  “_id”’ at the beginning of each element of splits and storing each element in the listradar_tickets_documents.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">radar_tickets_documents</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">splits</span><span class="p">))</span> <span class="p">:</span>

    <span class="n">radar_tickets_documents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="s1">&#39;{ </span><span class="se">\n</span><span class="s1">  &quot;_id&quot;&#39;</span> <span class="o">+</span> <span class="n">splits</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Fifth: save the list radar_tickets_documents as a json file.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;C:\Users\fscielzo\Documents\Large-Data\radar_tickets_new.json&quot;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">radar_tickets_documents</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Sixth: open the new json file build through previous steps. This is the json with which we will work.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;C:\Users\fscielzo\Documents\Large-Data\radar_tickets_new.json&quot;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">radar_tickets</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Seventh: insert by <code class="docutils literal notranslate"><span class="pre">insert_many</span></code> method the new json file in the created collection (radar_tickets_collection) created at the beginning, which was empty until now.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">radar_tickets_collection</span><span class="o">.</span><span class="n">insert_many</span><span class="p">(</span><span class="n">radar_tickets</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pymongo.results.InsertManyResult at 0x1730ac3f0d0&gt;
</pre></div>
</div>
</div>
</div>
<p>Counting the number of documents:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">radar_tickets_collection</span><span class="o">.</span><span class="n">count_documents</span><span class="p">({})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>50000
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">radar_tickets_collection</span><span class="o">.</span><span class="n">find</span><span class="p">({}))</span>
</pre></div>
</div>
</div>
</div>
<p>Here we display only a part of the previous output since it is massive to be displayed completely.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="p">{</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="s1">&#39;A1/-160/20130914132710000&#39;</span><span class="p">,</span>
  <span class="s1">&#39;dump date&#39;</span><span class="p">:</span> <span class="s1">&#39;02/10/18&#39;</span><span class="p">,</span>
  <span class="s1">&#39;road&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;speed limit&#39;</span><span class="p">:</span> <span class="mi">120</span><span class="p">},</span>
  <span class="s1">&#39;radar&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;mileage&#39;</span><span class="p">:</span> <span class="mi">160</span><span class="p">,</span> <span class="s1">&#39;direction&#39;</span><span class="p">:</span> <span class="s1">&#39;descending&#39;</span><span class="p">,</span> <span class="s1">&#39;speed limit&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">},</span>
  <span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;9495AIA&#39;</span><span class="p">,</span>
   <span class="s1">&#39;make&#39;</span><span class="p">:</span> <span class="s1">&#39;Fork&#39;</span><span class="p">,</span>
   <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;Bipua&#39;</span><span class="p">,</span>
   <span class="s1">&#39;power&#39;</span><span class="p">:</span> <span class="mi">1400</span><span class="p">,</span>
   <span class="s1">&#39;colour&#39;</span><span class="p">:</span> <span class="s1">&#39;gris&#39;</span><span class="p">,</span>
   <span class="s1">&#39;chassis number&#39;</span><span class="p">:</span> <span class="s1">&#39;OOQ95654Q25754626&#39;</span><span class="p">,</span>
   <span class="s1">&#39;registry date&#39;</span><span class="p">:</span> <span class="s1">&#39;Tuesday 10TH of July, 2007&#39;</span><span class="p">,</span>
   <span class="s1">&#39;roadworthiness&#39;</span><span class="p">:</span> <span class="s1">&#39;02/09/2010&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Driver&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;48906593Z&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Amarino&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Soto&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Baquerizo&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Calle del Roble, N 178, 92901&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;Valvacas de los Ciervos&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Phone number&#39;</span><span class="p">:</span> <span class="mi">555562373</span><span class="p">,</span>
    <span class="s1">&#39;Email&#39;</span><span class="p">:</span> <span class="s1">&#39;Nasas@servcorreo.uctreseme.edu&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;16/09/1946&#39;</span><span class="p">,</span>
    <span class="s1">&#39;driving license&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;04/06/2011&#39;</span><span class="p">}},</span>
   <span class="s1">&#39;Owner&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;30173036A&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Secundino&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Illescas&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Casanova&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Travesia San Crispulo, N 152, 67758&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;Sotodebajo&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Email&#39;</span><span class="p">:</span> <span class="s1">&#39;Seci@servcorreo.uctreseme.edu&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;05/04/1962&#39;</span><span class="p">}},</span>
  <span class="s1">&#39;Record&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;rec_ID&#39;</span><span class="p">:</span> <span class="mi">201325769096</span><span class="p">,</span>
   <span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="s1">&#39;E:/data/vid/20130914/10069096.avi&#39;</span><span class="p">,</span>
   <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;14/09/2013&#39;</span><span class="p">,</span>
   <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;13:27:10.000&#39;</span><span class="p">,</span>
   <span class="s1">&#39;speed&#39;</span><span class="p">:</span> <span class="mi">91</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="s1">&#39;M30/+11/20120410154721000&#39;</span><span class="p">,</span>
  <span class="s1">&#39;dump date&#39;</span><span class="p">:</span> <span class="s1">&#39;02/10/18&#39;</span><span class="p">,</span>
  <span class="s1">&#39;road&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;M30&#39;</span><span class="p">,</span> <span class="s1">&#39;speed limit&#39;</span><span class="p">:</span> <span class="mi">70</span><span class="p">},</span>
  <span class="s1">&#39;radar&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;mileage&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;direction&#39;</span><span class="p">:</span> <span class="s1">&#39;ascending&#39;</span><span class="p">,</span> <span class="s1">&#39;speed limit&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">},</span>
  <span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;9063AOI&#39;</span><span class="p">,</span>
   <span class="s1">&#39;make&#39;</span><span class="p">:</span> <span class="s1">&#39;Rinaul&#39;</span><span class="p">,</span>
   <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;Arroyo&#39;</span><span class="p">,</span>
   <span class="s1">&#39;power&#39;</span><span class="p">:</span> <span class="mi">1600</span><span class="p">,</span>
   <span class="s1">&#39;colour&#39;</span><span class="p">:</span> <span class="s1">&#39;plateado&#39;</span><span class="p">,</span>
   <span class="s1">&#39;chassis number&#39;</span><span class="p">:</span> <span class="s1">&#39;QQO35197I53881067&#39;</span><span class="p">,</span>
   <span class="s1">&#39;registry date&#39;</span><span class="p">:</span> <span class="s1">&#39;Sunday 25TH of November, 2007&#39;</span><span class="p">,</span>
   <span class="s1">&#39;roadworthiness&#39;</span><span class="p">:</span> <span class="s1">&#39;28/08/2011&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Driver&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;48272209Q&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;agata&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Marquina&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Granda&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Plaza del Pozo, N 133, 90558&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;Villapiedras&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Phone number&#39;</span><span class="p">:</span> <span class="mi">555551208</span><span class="p">,</span>
    <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;01/11/1952&#39;</span><span class="p">,</span>
    <span class="s1">&#39;driving license&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;20/04/2004&#39;</span><span class="p">}},</span>
   <span class="s1">&#39;Owner&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;22649968M&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Maria del Mar&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Diaz&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Zuniga&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Avenida del Arroyo, N 153, 67758&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;Sotodebajo&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Phone number&#39;</span><span class="p">:</span> <span class="mi">555571262</span><span class="p">,</span>
    <span class="s1">&#39;Email&#39;</span><span class="p">:</span> <span class="s1">&#39;Coscha@servcorreo.uctreseme.edu&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;11/02/1956&#39;</span><span class="p">}},</span>
  <span class="s1">&#39;Record&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;rec_ID&#39;</span><span class="p">:</span> <span class="mi">201210169095</span><span class="p">,</span>
   <span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="s1">&#39;E:/data/vid/20120410/10069095.avi&#39;</span><span class="p">,</span>
   <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;10/04/2012&#39;</span><span class="p">,</span>
   <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;15:47:21.000&#39;</span><span class="p">,</span>
   <span class="s1">&#39;speed&#39;</span><span class="p">:</span> <span class="mi">69</span><span class="p">},</span>
  <span class="s1">&#39;Speed ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Amount&#39;</span><span class="p">:</span> <span class="mi">190</span><span class="p">,</span>
   <span class="s1">&#39;Currency&#39;</span><span class="p">:</span> <span class="s1">&#39;euro&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Debtor&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;22649968M&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Maria del Mar&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Diaz&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Zuniga&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Avenida del Arroyo, N 153, 67758&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;Sotodebajo&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Phone number&#39;</span><span class="p">:</span> <span class="mi">555571262</span><span class="p">,</span>
    <span class="s1">&#39;Email&#39;</span><span class="p">:</span> <span class="s1">&#39;Coscha@servcorreo.uctreseme.edu&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;11/02/1956&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Insolvency&#39;</span><span class="p">:</span> <span class="s1">&#39;No&#39;</span><span class="p">},</span>
   <span class="s1">&#39;Pay date&#39;</span><span class="p">:</span> <span class="s1">&#39;11/05/2018&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Pay type&#39;</span><span class="p">:</span> <span class="s1">&#39;bank transfer&#39;</span><span class="p">,</span>
   <span class="s1">&#39;State&#39;</span><span class="p">:</span> <span class="s1">&#39;fullfilled&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="s1">&#39;A2/+10/20120510155119000&#39;</span><span class="p">,</span>
  <span class="s1">&#39;dump date&#39;</span><span class="p">:</span> <span class="s1">&#39;02/10/18&#39;</span><span class="p">,</span>
  <span class="s1">&#39;road&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;speed limit&#39;</span><span class="p">:</span> <span class="mi">120</span><span class="p">},</span>
  <span class="s1">&#39;radar&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;mileage&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;direction&#39;</span><span class="p">:</span> <span class="s1">&#39;ascending&#39;</span><span class="p">,</span> <span class="s1">&#39;speed limit&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">},</span>
  <span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;6111IAI&#39;</span><span class="p">,</span>
   <span class="s1">&#39;make&#39;</span><span class="p">:</span> <span class="s1">&#39;Rinaul&#39;</span><span class="p">,</span>
   <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;Fuente&#39;</span><span class="p">,</span>
   <span class="s1">&#39;power&#39;</span><span class="p">:</span> <span class="mi">1400</span><span class="p">,</span>
   <span class="s1">&#39;colour&#39;</span><span class="p">:</span> <span class="s1">&#39;dorado&#39;</span><span class="p">,</span>
   <span class="s1">&#39;chassis number&#39;</span><span class="p">:</span> <span class="s1">&#39;QIO78629I56366773&#39;</span><span class="p">,</span>
   <span class="s1">&#39;registry date&#39;</span><span class="p">:</span> <span class="s1">&#39;Monday 25TH of October, 2004&#39;</span><span class="p">,</span>
   <span class="s1">&#39;roadworthiness&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;MOT date&#39;</span><span class="p">:</span> <span class="s1">&#39;06/01/2009&#39;</span><span class="p">,</span>
     <span class="s1">&#39;shortcomings&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;insufficient braking&#39;</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;MOT date&#39;</span><span class="p">:</span> <span class="s1">&#39;18/12/2008&#39;</span><span class="p">,</span> <span class="s1">&#39;shortcomings&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;worn tires&#39;</span><span class="p">,</span> <span class="s1">&#39;minor faults&#39;</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;MOT date&#39;</span><span class="p">:</span> <span class="s1">&#39;09/01/2009&#39;</span><span class="p">,</span> <span class="s1">&#39;shortcomings&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;broken headlight&#39;</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;MOT date&#39;</span><span class="p">:</span> <span class="s1">&#39;26/12/2011&#39;</span><span class="p">,</span> <span class="s1">&#39;shortcomings&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;defective bulb&#39;</span><span class="p">]}],</span>
   <span class="s1">&#39;Driver&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;70809340E&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Maria de la Epifania&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Perez&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Rodriguez&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Avenida de las Carretas, N 153, 87344&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;Villatrigos de Manteca&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Phone number&#39;</span><span class="p">:</span> <span class="mi">555719522</span><span class="p">,</span>
    <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;24/01/1958&#39;</span><span class="p">,</span>
    <span class="s1">&#39;driving license&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;31/12/2007&#39;</span><span class="p">}},</span>
   <span class="s1">&#39;Owner&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;70809340E&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Maria de la Epifania&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Perez&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Rodriguez&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Avenida de las Carretas, N 153, 87344&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;Villatrigos de Manteca&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Phone number&#39;</span><span class="p">:</span> <span class="mi">555719522</span><span class="p">,</span>
    <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;24/01/1958&#39;</span><span class="p">}},</span>
  <span class="s1">&#39;Record&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;rec_ID&#39;</span><span class="p">:</span> <span class="mi">201213169094</span><span class="p">,</span>
   <span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="s1">&#39;E:/data/vid/20120510/10069094.avi&#39;</span><span class="p">,</span>
   <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;10/05/2012&#39;</span><span class="p">,</span>
   <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;15:51:19.000&#39;</span><span class="p">,</span>
   <span class="s1">&#39;speed&#39;</span><span class="p">:</span> <span class="mi">123</span><span class="p">},</span>
  <span class="s1">&#39;Speed ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Amount&#39;</span><span class="p">:</span> <span class="mi">230</span><span class="p">,</span>
   <span class="s1">&#39;Currency&#39;</span><span class="p">:</span> <span class="s1">&#39;euro&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Debtor&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;70809340E&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Maria de la Epifania&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Perez&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Rodriguez&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Avenida de las Carretas, N 153, 87344&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;Villatrigos de Manteca&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Phone number&#39;</span><span class="p">:</span> <span class="mi">555719522</span><span class="p">,</span>
    <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;24/01/1958&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Insolvency&#39;</span><span class="p">:</span> <span class="s1">&#39;No&#39;</span><span class="p">},</span>
   <span class="s1">&#39;Pay date&#39;</span><span class="p">:</span> <span class="s1">&#39;08/05/2018&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Pay type&#39;</span><span class="p">:</span> <span class="s1">&#39;bank transfer&#39;</span><span class="p">,</span>
   <span class="s1">&#39;State&#39;</span><span class="p">:</span> <span class="s1">&#39;fullfilled&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="s1">&#39;A3/-206/20120925201344000&#39;</span><span class="p">,</span>
  <span class="s1">&#39;dump date&#39;</span><span class="p">:</span> <span class="s1">&#39;02/10/18&#39;</span><span class="p">,</span>
  <span class="s1">&#39;road&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;A3&#39;</span><span class="p">,</span> <span class="s1">&#39;speed limit&#39;</span><span class="p">:</span> <span class="mi">120</span><span class="p">},</span>
  <span class="s1">&#39;radar&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;mileage&#39;</span><span class="p">:</span> <span class="mi">206</span><span class="p">,</span> <span class="s1">&#39;direction&#39;</span><span class="p">:</span> <span class="s1">&#39;descending&#39;</span><span class="p">,</span> <span class="s1">&#39;speed limit&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">},</span>
  <span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;8686IUU&#39;</span><span class="p">,</span>
   <span class="s1">&#39;make&#39;</span><span class="p">:</span> <span class="s1">&#39;Fork&#39;</span><span class="p">,</span>
   <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;Tetrox&#39;</span><span class="p">,</span>
   <span class="s1">&#39;power&#39;</span><span class="p">:</span> <span class="mi">1400</span><span class="p">,</span>
   <span class="s1">&#39;colour&#39;</span><span class="p">:</span> <span class="s1">&#39;dorado&#39;</span><span class="p">,</span>
   <span class="s1">&#39;chassis number&#39;</span><span class="p">:</span> <span class="s1">&#39;OQO43241Q19559486&#39;</span><span class="p">,</span>
   <span class="s1">&#39;registry date&#39;</span><span class="p">:</span> <span class="s1">&#39;Saturday 31ST of August, 2002&#39;</span><span class="p">,</span>
   <span class="s1">&#39;roadworthiness&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;MOT date&#39;</span><span class="p">:</span> <span class="s1">&#39;08/11/2006&#39;</span><span class="p">,</span>
     <span class="s1">&#39;shortcomings&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;broken headlight&#39;</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;MOT date&#39;</span><span class="p">:</span> <span class="s1">&#39;23/11/2006&#39;</span><span class="p">,</span> <span class="s1">&#39;shortcomings&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;spoiled engine&#39;</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;MOT date&#39;</span><span class="p">:</span> <span class="s1">&#39;12/11/2006&#39;</span><span class="p">,</span> <span class="s1">&#39;shortcomings&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;broken headlight&#39;</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;MOT date&#39;</span><span class="p">:</span> <span class="s1">&#39;20/11/2006&#39;</span><span class="p">,</span> <span class="s1">&#39;shortcomings&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;damaged license plate&#39;</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;MOT date&#39;</span><span class="p">:</span> <span class="s1">&#39;12/11/2010&#39;</span><span class="p">}],</span>
   <span class="s1">&#39;Driver&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;95875344M&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Andres&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Matos&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Osorio&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Calle Curtidores, N 161, 61231&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;Sierra de los Trigos&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Phone number&#39;</span><span class="p">:</span> <span class="mi">555622987</span><span class="p">,</span>
    <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;01/09/1949&#39;</span><span class="p">,</span>
    <span class="s1">&#39;driving license&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;D1&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;18/04/2006&#39;</span><span class="p">}},</span>
   <span class="s1">&#39;Owner&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;95875344M&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Andres&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Matos&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Osorio&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Calle Curtidores, N 161, 61231&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;Sierra de los Trigos&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Phone number&#39;</span><span class="p">:</span> <span class="mi">555622987</span><span class="p">,</span>
    <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;01/09/1949&#39;</span><span class="p">}},</span>
  <span class="s1">&#39;Record&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;rec_ID&#39;</span><span class="p">:</span> <span class="mi">201226969093</span><span class="p">,</span>
   <span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="s1">&#39;E:/data/vid/20120925/10069093.avi&#39;</span><span class="p">,</span>
   <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;25/09/2012&#39;</span><span class="p">,</span>
   <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;20:13:44.000&#39;</span><span class="p">,</span>
   <span class="s1">&#39;speed&#39;</span><span class="p">:</span> <span class="mi">98</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="s1">&#39;M50/-18/20121208201828000&#39;</span><span class="p">,</span>
  <span class="s1">&#39;dump date&#39;</span><span class="p">:</span> <span class="s1">&#39;02/10/18&#39;</span><span class="p">,</span>
  <span class="s1">&#39;road&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;M50&#39;</span><span class="p">,</span> <span class="s1">&#39;speed limit&#39;</span><span class="p">:</span> <span class="mi">120</span><span class="p">},</span>
  <span class="s1">&#39;radar&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;mileage&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span> <span class="s1">&#39;direction&#39;</span><span class="p">:</span> <span class="s1">&#39;descending&#39;</span><span class="p">,</span> <span class="s1">&#39;speed limit&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">},</span>
  <span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;7696UOA&#39;</span><span class="p">,</span>
   <span class="s1">&#39;make&#39;</span><span class="p">:</span> <span class="s1">&#39;Peuyo&#39;</span><span class="p">,</span>
   <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;Real&#39;</span><span class="p">,</span>
   <span class="s1">&#39;power&#39;</span><span class="p">:</span> <span class="mi">1400</span><span class="p">,</span>
   <span class="s1">&#39;colour&#39;</span><span class="p">:</span> <span class="s1">&#39;gris metalizado&#39;</span><span class="p">,</span>
   <span class="s1">&#39;chassis number&#39;</span><span class="p">:</span> <span class="s1">&#39;OOI78032I91035606&#39;</span><span class="p">,</span>
   <span class="s1">&#39;registry date&#39;</span><span class="p">:</span> <span class="s1">&#39;Friday 9TH of March, 2007&#39;</span><span class="p">,</span>
   <span class="s1">&#39;roadworthiness&#39;</span><span class="p">:</span> <span class="s1">&#39;01/08/2010&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Driver&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;58793740J&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Honorata&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Alcantara&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Lema&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Travesia del Encinar, N 23, 12969&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;Villanieves de la Alameda&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Email&#39;</span><span class="p">:</span> <span class="s1">&#39;Alci@servcorreo.uctreseme.edu&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;21/11/1972&#39;</span><span class="p">,</span>
    <span class="s1">&#39;driving license&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;05/10/2001&#39;</span><span class="p">}},</span>
   <span class="s1">&#39;Owner&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;46197994X&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Carlos&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Avendano&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Delgado&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Calle Carpinteros, N 199, 72686&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;Sototorres de Arriba&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Email&#39;</span><span class="p">:</span> <span class="s1">&#39;Delgui@servcorreo.uctreseme.edu&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;25/08/1957&#39;</span><span class="p">}},</span>
  <span class="s1">&#39;Record&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;rec_ID&#39;</span><span class="p">:</span> <span class="mi">201234369092</span><span class="p">,</span>
   <span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="s1">&#39;E:/data/vid/20121208/10069092.avi&#39;</span><span class="p">,</span>
   <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;08/12/2012&#39;</span><span class="p">,</span>
   <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;20:18:28.000&#39;</span><span class="p">,</span>
   <span class="s1">&#39;speed&#39;</span><span class="p">:</span> <span class="mi">112</span><span class="p">},</span>
  <span class="s1">&#39;Speed ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Amount&#39;</span><span class="p">:</span> <span class="mi">120</span><span class="p">,</span>
   <span class="s1">&#39;Currency&#39;</span><span class="p">:</span> <span class="s1">&#39;euro&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Debtor&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;46197994X&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Carlos&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Avendano&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Delgado&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Calle Carpinteros, N 199, 72686&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;Sototorres de Arriba&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Email&#39;</span><span class="p">:</span> <span class="s1">&#39;Delgui@servcorreo.uctreseme.edu&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;25/08/1957&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Insolvency&#39;</span><span class="p">:</span> <span class="s1">&#39;No&#39;</span><span class="p">},</span>
   <span class="s1">&#39;State&#39;</span><span class="p">:</span> <span class="s1">&#39;appealed&#39;</span><span class="p">}},</span> 
   <span class="o">...</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">radar_tickets_collection_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">radar_tickets_collection</span><span class="o">.</span><span class="n">find</span><span class="p">({}))</span>
</pre></div>
</div>
</div>
</div>
<p>Taking a look to two documents of the collection, just for getting an idea of how them look like.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">radar_tickets_collection_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;_id&#39;: &#39;M30/-31/20091205175543130&#39;,
 &#39;dump date&#39;: &#39;02/10/18&#39;,
 &#39;road&#39;: {&#39;name&#39;: &#39;M30&#39;, &#39;speed limit&#39;: 70},
 &#39;radar&#39;: {&#39;mileage&#39;: 31, &#39;direction&#39;: &#39;descending&#39;, &#39;speed limit&#39;: 50},
 &#39;vehicle&#39;: {&#39;number plate&#39;: &#39;7919AEO&#39;,
  &#39;make&#39;: &#39;Rinaul&#39;,
  &#39;model&#39;: &#39;Fuente&#39;,
  &#39;power&#39;: 1400,
  &#39;colour&#39;: &#39;marron&#39;,
  &#39;chassis number&#39;: &#39;QOI84163Q14980235&#39;,
  &#39;registry date&#39;: &#39;Thursday 29TH of May, 2008&#39;,
  &#39;roadworthiness&#39;: &#39;22/10/2011&#39;,
  &#39;Driver&#39;: {&#39;DNI&#39;: &#39;21987229B&#39;,
   &#39;Name&#39;: &#39;Ana Nuria&#39;,
   &#39;Surname&#39;: &#39;Mory&#39;,
   &#39;Sec_Surname&#39;: &#39;Ortiz&#39;,
   &#39;Address&#39;: &#39;Paseo Lope de Vega, N 156, 69676&#39;,
   &#39;Town&#39;: &#39;Sotosombras del Lago&#39;,
   &#39;Phone number&#39;: 555153476,
   &#39;Email&#39;: &#39;AMory@servcorreo.uctreseme.edu&#39;,
   &#39;Birthdate&#39;: &#39;16/02/1991&#39;,
   &#39;driving license&#39;: {&#39;type&#39;: &#39;B&#39;, &#39;date&#39;: &#39;25/06/1999&#39;}},
  &#39;Owner&#39;: {&#39;DNI&#39;: &#39;21987229B&#39;,
   &#39;Name&#39;: &#39;Ana Nuria&#39;,
   &#39;Surname&#39;: &#39;Mory&#39;,
   &#39;Sec_Surname&#39;: &#39;Ortiz&#39;,
   &#39;Address&#39;: &#39;Paseo Lope de Vega, N 156, 69676&#39;,
   &#39;Town&#39;: &#39;Sotosombras del Lago&#39;,
   &#39;Phone number&#39;: 555153476,
   &#39;Email&#39;: &#39;AMory@servcorreo.uctreseme.edu&#39;,
   &#39;Birthdate&#39;: &#39;16/02/1991&#39;}},
 &#39;Record&#39;: {&#39;rec_ID&#39;: 200933969999,
  &#39;file&#39;: &#39;E:/data/vid/20091205/10069999.avi&#39;,
  &#39;date&#39;: &#39;05/12/2009&#39;,
  &#39;time&#39;: &#39;17:55:43.130&#39;,
  &#39;speed&#39;: 50}}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">radar_tickets_collection_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dict_keys([&#39;_id&#39;, &#39;dump date&#39;, &#39;road&#39;, &#39;radar&#39;, &#39;vehicle&#39;, &#39;Record&#39;])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">radar_tickets_collection_list</span><span class="p">[</span><span class="mi">150</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;_id&#39;: &#39;A5/+274/20120409212407000&#39;,
 &#39;dump date&#39;: &#39;02/10/18&#39;,
 &#39;road&#39;: {&#39;name&#39;: &#39;A5&#39;, &#39;speed limit&#39;: 120},
 &#39;radar&#39;: {&#39;mileage&#39;: 274, &#39;direction&#39;: &#39;ascending&#39;, &#39;speed limit&#39;: 100},
 &#39;vehicle&#39;: {&#39;number plate&#39;: &#39;8828OIA&#39;,
  &#39;make&#39;: &#39;Rinaul&#39;,
  &#39;model&#39;: &#39;Manante&#39;,
  &#39;power&#39;: 1600,
  &#39;colour&#39;: &#39;gris&#39;,
  &#39;chassis number&#39;: &#39;IOI77370I57501874&#39;,
  &#39;registry date&#39;: &#39;Monday 4TH of September, 2006&#39;,
  &#39;roadworthiness&#39;: [{&#39;MOT date&#39;: &#39;13/09/2009&#39;,
    &#39;shortcomings&#39;: [&#39;damaged license plate&#39;]},
   {&#39;MOT date&#39;: &#39;16/09/2010&#39;, &#39;shortcomings&#39;: [&#39;broken hand brake&#39;]}],
  &#39;Driver&#39;: {&#39;DNI&#39;: &#39;63709185J&#39;,
   &#39;Name&#39;: &#39;Maria Quintina&#39;,
   &#39;Surname&#39;: &#39;Babilon&#39;,
   &#39;Sec_Surname&#39;: &#39;Huapaya&#39;,
   &#39;Address&#39;: &#39;Travesia del Silo, N 164, 29869&#39;,
   &#39;Town&#39;: &#39;San Juan de las Golondrinas&#39;,
   &#39;Phone number&#39;: 555582881,
   &#39;Email&#39;: &#39;Babika@servcorreo.uctreseme.edu&#39;,
   &#39;Birthdate&#39;: &#39;09/11/1991&#39;,
   &#39;driving license&#39;: {&#39;type&#39;: &#39;B&#39;, &#39;date&#39;: &#39;03/05/2008&#39;}},
  &#39;Owner&#39;: {&#39;DNI&#39;: &#39;46104267P&#39;,
   &#39;Name&#39;: &#39;Felicidad&#39;,
   &#39;Surname&#39;: &#39;Hidroso&#39;,
   &#39;Sec_Surname&#39;: &#39;Torres&#39;,
   &#39;Address&#39;: &#39;Avenida Estiradores, N 167, 65776&#39;,
   &#39;Town&#39;: &#39;Serrania de las Setas&#39;,
   &#39;Phone number&#39;: 555031873,
   &#39;Birthdate&#39;: &#39;23/11/1959&#39;}},
 &#39;Record&#39;: {&#39;rec_ID&#39;: 201210069849,
  &#39;file&#39;: &#39;E:/data/vid/20120409/10069849.avi&#39;,
  &#39;date&#39;: &#39;09/04/2012&#39;,
  &#39;time&#39;: &#39;21:24:07.000&#39;,
  &#39;speed&#39;: 108},
 &#39;Speed ticket&#39;: {&#39;Issue date&#39;: &#39;27/04/2018&#39;,
  &#39;Amount&#39;: 80,
  &#39;Currency&#39;: &#39;euro&#39;,
  &#39;Debtor&#39;: {&#39;DNI&#39;: &#39;46104267P&#39;,
   &#39;Name&#39;: &#39;Felicidad&#39;,
   &#39;Surname&#39;: &#39;Hidroso&#39;,
   &#39;Sec_Surname&#39;: &#39;Torres&#39;,
   &#39;Address&#39;: &#39;Avenida Estiradores, N 167, 65776&#39;,
   &#39;Town&#39;: &#39;Serrania de las Setas&#39;,
   &#39;Phone number&#39;: 555031873,
   &#39;Birthdate&#39;: &#39;23/11/1959&#39;,
   &#39;Insolvency&#39;: &#39;No&#39;},
  &#39;State&#39;: &#39;appealed&#39;}}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">radar_tickets_collection_list</span><span class="p">[</span><span class="mi">150</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dict_keys([&#39;_id&#39;, &#39;dump date&#39;, &#39;road&#39;, &#39;radar&#39;, &#39;vehicle&#39;, &#39;Record&#39;, &#39;Speed ticket&#39;])
</pre></div>
</div>
</div>
</div>
<section id="query-1">
<h3><strong>Query 1</strong><a class="headerlink" href="#query-1" title="Link to this heading">#</a></h3>
<p><strong>Retrieve radar recordings (whole document) with a speed ticket
greater than or equal to €750. Keep only documents where the driver is also the owner of
the car (the same person).</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># To check for documents where Driver.DNI and Owner.DNI have the same value, you should use the $expr operator. </span>

<span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;$and&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;Speed ticket.Amount&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$gte&quot;</span><span class="p">:</span> <span class="mi">750</span><span class="p">}},</span> 
                  <span class="p">{</span><span class="s2">&quot;$expr&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$eq&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;$vehicle.Driver.DNI&quot;</span><span class="p">,</span> <span class="s2">&quot;$vehicle.Owner.DNI&quot;</span><span class="p">]}}]}</span>
<span class="nb">list</span><span class="p">(</span><span class="n">radar_tickets_collection</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">query</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[]
</pre></div>
</div>
</div>
</div>
<p>As you can see, any document is returned, because there is no one matching the query.</p>
<p>In order to test the query we are going to include some new documents that satisfy it.</p>
<p><strong>Testing the query</strong></p>
<ul class="simple">
<li><p>Same owner as driver and speed ticker &gt; 750</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">radar_tickets_collection</span><span class="o">.</span><span class="n">insert_one</span><span class="p">({</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="s1">&#39;A5/+274/20120409212407001&#39;</span><span class="p">,</span>
 <span class="s1">&#39;dump date&#39;</span><span class="p">:</span> <span class="s1">&#39;02/10/18&#39;</span><span class="p">,</span>
 <span class="s1">&#39;road&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;A5&#39;</span><span class="p">,</span> <span class="s1">&#39;speed limit&#39;</span><span class="p">:</span> <span class="mi">120</span><span class="p">},</span>
 <span class="s1">&#39;radar&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;mileage&#39;</span><span class="p">:</span> <span class="mi">274</span><span class="p">,</span> <span class="s1">&#39;direction&#39;</span><span class="p">:</span> <span class="s1">&#39;ascending&#39;</span><span class="p">,</span> <span class="s1">&#39;speed limit&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">},</span>
 <span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;8828OIA&#39;</span><span class="p">,</span>
  <span class="s1">&#39;make&#39;</span><span class="p">:</span> <span class="s1">&#39;Rinaul&#39;</span><span class="p">,</span>
  <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;Manante&#39;</span><span class="p">,</span>
  <span class="s1">&#39;power&#39;</span><span class="p">:</span> <span class="mi">1600</span><span class="p">,</span>
  <span class="s1">&#39;colour&#39;</span><span class="p">:</span> <span class="s1">&#39;gris&#39;</span><span class="p">,</span>
  <span class="s1">&#39;chassis number&#39;</span><span class="p">:</span> <span class="s1">&#39;IOI77370I57501874&#39;</span><span class="p">,</span>
  <span class="s1">&#39;registry date&#39;</span><span class="p">:</span> <span class="s1">&#39;Monday 4TH of September, 2006&#39;</span><span class="p">,</span>
  <span class="s1">&#39;roadworthiness&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;MOT date&#39;</span><span class="p">:</span> <span class="s1">&#39;13/09/2009&#39;</span><span class="p">,</span>
    <span class="s1">&#39;shortcomings&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;damaged license plate&#39;</span><span class="p">]},</span>
   <span class="p">{</span><span class="s1">&#39;MOT date&#39;</span><span class="p">:</span> <span class="s1">&#39;16/09/2010&#39;</span><span class="p">,</span> <span class="s1">&#39;shortcomings&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;broken hand brake&#39;</span><span class="p">]}],</span>
  <span class="s1">&#39;Driver&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;63709185J&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Maria Quintina&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Babilon&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Huapaya&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Travesia del Silo, N 164, 29869&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;San Juan de las Golondrinas&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Phone number&#39;</span><span class="p">:</span> <span class="mi">555582881</span><span class="p">,</span>
   <span class="s1">&#39;Email&#39;</span><span class="p">:</span> <span class="s1">&#39;Babika@servcorreo.uctreseme.edu&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;09/11/1991&#39;</span><span class="p">,</span>
   <span class="s1">&#39;driving license&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;03/05/2008&#39;</span><span class="p">}},</span>
  <span class="s1">&#39;Owner&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;63709185J&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Maria Quintina&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Babilon&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Huapaya&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Travesia del Silo, N 164, 29869&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;San Juan de las Golondrinas&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Phone number&#39;</span><span class="p">:</span> <span class="mi">555582881</span><span class="p">,</span>
   <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;09/11/1991&#39;</span><span class="p">}},</span>
 <span class="s1">&#39;Record&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;rec_ID&#39;</span><span class="p">:</span> <span class="mi">201210069849</span><span class="p">,</span>
  <span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="s1">&#39;E:/data/vid/20120409/10069849.avi&#39;</span><span class="p">,</span>
  <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;09/04/2012&#39;</span><span class="p">,</span>
  <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;21:24:07.000&#39;</span><span class="p">,</span>
  <span class="s1">&#39;speed&#39;</span><span class="p">:</span> <span class="mi">108</span><span class="p">},</span>
 <span class="s1">&#39;Speed ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Amount&#39;</span><span class="p">:</span> <span class="mi">850</span><span class="p">,</span>
  <span class="s1">&#39;Currency&#39;</span><span class="p">:</span> <span class="s1">&#39;euro&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Debtor&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;46104267P&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Felicidad&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Hidroso&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Torres&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Avenida Estiradores, N 167, 65776&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;Serrania de las Setas&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Phone number&#39;</span><span class="p">:</span> <span class="mi">555031873</span><span class="p">,</span>
   <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;23/11/1959&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Insolvency&#39;</span><span class="p">:</span> <span class="s1">&#39;No&#39;</span><span class="p">},</span>
  <span class="s1">&#39;State&#39;</span><span class="p">:</span> <span class="s1">&#39;appealed&#39;</span><span class="p">}})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pymongo.results.InsertOneResult at 0x1737153a740&gt;
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Same owner as driver but speed ticker &lt; 750</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">radar_tickets_collection</span><span class="o">.</span><span class="n">insert_one</span><span class="p">({</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="s1">&#39;A5/+274/20120409212407002&#39;</span><span class="p">,</span>
 <span class="s1">&#39;dump date&#39;</span><span class="p">:</span> <span class="s1">&#39;02/10/18&#39;</span><span class="p">,</span>
 <span class="s1">&#39;road&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;A5&#39;</span><span class="p">,</span> <span class="s1">&#39;speed limit&#39;</span><span class="p">:</span> <span class="mi">120</span><span class="p">},</span>
 <span class="s1">&#39;radar&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;mileage&#39;</span><span class="p">:</span> <span class="mi">274</span><span class="p">,</span> <span class="s1">&#39;direction&#39;</span><span class="p">:</span> <span class="s1">&#39;ascending&#39;</span><span class="p">,</span> <span class="s1">&#39;speed limit&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">},</span>
 <span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;8828OIA&#39;</span><span class="p">,</span>
  <span class="s1">&#39;make&#39;</span><span class="p">:</span> <span class="s1">&#39;Rinaul&#39;</span><span class="p">,</span>
  <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;Manante&#39;</span><span class="p">,</span>
  <span class="s1">&#39;power&#39;</span><span class="p">:</span> <span class="mi">1600</span><span class="p">,</span>
  <span class="s1">&#39;colour&#39;</span><span class="p">:</span> <span class="s1">&#39;gris&#39;</span><span class="p">,</span>
  <span class="s1">&#39;chassis number&#39;</span><span class="p">:</span> <span class="s1">&#39;IOI77370I57501874&#39;</span><span class="p">,</span>
  <span class="s1">&#39;registry date&#39;</span><span class="p">:</span> <span class="s1">&#39;Monday 4TH of September, 2006&#39;</span><span class="p">,</span>
  <span class="s1">&#39;roadworthiness&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;MOT date&#39;</span><span class="p">:</span> <span class="s1">&#39;13/09/2009&#39;</span><span class="p">,</span>
    <span class="s1">&#39;shortcomings&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;damaged license plate&#39;</span><span class="p">]},</span>
   <span class="p">{</span><span class="s1">&#39;MOT date&#39;</span><span class="p">:</span> <span class="s1">&#39;16/09/2010&#39;</span><span class="p">,</span> <span class="s1">&#39;shortcomings&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;broken hand brake&#39;</span><span class="p">]}],</span>
  <span class="s1">&#39;Driver&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;63709185J&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Maria Quintina&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Babilon&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Huapaya&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Travesia del Silo, N 164, 29869&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;San Juan de las Golondrinas&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Phone number&#39;</span><span class="p">:</span> <span class="mi">555582881</span><span class="p">,</span>
   <span class="s1">&#39;Email&#39;</span><span class="p">:</span> <span class="s1">&#39;Babika@servcorreo.uctreseme.edu&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;09/11/1991&#39;</span><span class="p">,</span>
   <span class="s1">&#39;driving license&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;03/05/2008&#39;</span><span class="p">}},</span>
  <span class="s1">&#39;Owner&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;41223185Z&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Fabio&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Scielzo&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Ortiz&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Paseo de la Castellana, 22&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;Madrid&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Phone number&#39;</span><span class="p">:</span> <span class="mi">552382881</span><span class="p">,</span>
   <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;29/08/1998&#39;</span><span class="p">}},</span>
 <span class="s1">&#39;Record&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;rec_ID&#39;</span><span class="p">:</span> <span class="mi">201210069849</span><span class="p">,</span>
  <span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="s1">&#39;E:/data/vid/20120409/10069849.avi&#39;</span><span class="p">,</span>
  <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;09/04/2012&#39;</span><span class="p">,</span>
  <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;21:24:07.000&#39;</span><span class="p">,</span>
  <span class="s1">&#39;speed&#39;</span><span class="p">:</span> <span class="mi">108</span><span class="p">},</span>
 <span class="s1">&#39;Speed ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Amount&#39;</span><span class="p">:</span> <span class="mi">225</span><span class="p">,</span>
  <span class="s1">&#39;Currency&#39;</span><span class="p">:</span> <span class="s1">&#39;euro&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Debtor&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;46104267P&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Felicidad&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Hidroso&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Torres&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Avenida Estiradores, N 167, 65776&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;Serrania de las Setas&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Phone number&#39;</span><span class="p">:</span> <span class="mi">555031873</span><span class="p">,</span>
   <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;23/11/1959&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Insolvency&#39;</span><span class="p">:</span> <span class="s1">&#39;No&#39;</span><span class="p">},</span>
  <span class="s1">&#39;State&#39;</span><span class="p">:</span> <span class="s1">&#39;appealed&#39;</span><span class="p">}})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pymongo.results.InsertOneResult at 0x1738a57aa10&gt;
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Same owner as driver but speed ticket == 750</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">radar_tickets_collection</span><span class="o">.</span><span class="n">insert_one</span><span class="p">({</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="s1">&#39;A5/+274/20120409212407005&#39;</span><span class="p">,</span>
 <span class="s1">&#39;dump date&#39;</span><span class="p">:</span> <span class="s1">&#39;02/10/18&#39;</span><span class="p">,</span>
 <span class="s1">&#39;road&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;A5&#39;</span><span class="p">,</span> <span class="s1">&#39;speed limit&#39;</span><span class="p">:</span> <span class="mi">120</span><span class="p">},</span>
 <span class="s1">&#39;radar&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;mileage&#39;</span><span class="p">:</span> <span class="mi">274</span><span class="p">,</span> <span class="s1">&#39;direction&#39;</span><span class="p">:</span> <span class="s1">&#39;ascending&#39;</span><span class="p">,</span> <span class="s1">&#39;speed limit&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">},</span>
 <span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;8828OIA&#39;</span><span class="p">,</span>
  <span class="s1">&#39;make&#39;</span><span class="p">:</span> <span class="s1">&#39;Rinaul&#39;</span><span class="p">,</span>
  <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;Manante&#39;</span><span class="p">,</span>
  <span class="s1">&#39;power&#39;</span><span class="p">:</span> <span class="mi">1600</span><span class="p">,</span>
  <span class="s1">&#39;colour&#39;</span><span class="p">:</span> <span class="s1">&#39;gris&#39;</span><span class="p">,</span>
  <span class="s1">&#39;chassis number&#39;</span><span class="p">:</span> <span class="s1">&#39;IOI77370I57501874&#39;</span><span class="p">,</span>
  <span class="s1">&#39;registry date&#39;</span><span class="p">:</span> <span class="s1">&#39;Monday 4TH of September, 2006&#39;</span><span class="p">,</span>
  <span class="s1">&#39;roadworthiness&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;MOT date&#39;</span><span class="p">:</span> <span class="s1">&#39;13/09/2009&#39;</span><span class="p">,</span>
    <span class="s1">&#39;shortcomings&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;damaged license plate&#39;</span><span class="p">]},</span>
   <span class="p">{</span><span class="s1">&#39;MOT date&#39;</span><span class="p">:</span> <span class="s1">&#39;16/09/2010&#39;</span><span class="p">,</span> <span class="s1">&#39;shortcomings&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;broken hand brake&#39;</span><span class="p">]}],</span>
  <span class="s1">&#39;Driver&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;12309185X&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Pedro&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Morata&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Lago&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Travesia del Silo, N 164, 29869&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;San Juan de las Golondrinas&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Phone number&#39;</span><span class="p">:</span> <span class="mi">552282381</span><span class="p">,</span>
   <span class="s1">&#39;Email&#39;</span><span class="p">:</span> <span class="s1">&#39;pedroML@gmail.com&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;09/11/1991&#39;</span><span class="p">,</span>
   <span class="s1">&#39;driving license&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;04/08/2007&#39;</span><span class="p">}},</span>
  <span class="s1">&#39;Owner&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;12309185X&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Pedro&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Morata&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Lago&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Travesia del Silo, N 164, 29869&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;San Juan de las Golondrinas&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Phone number&#39;</span><span class="p">:</span> <span class="mi">552282381</span><span class="p">,</span>
   <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;09/11/1991&#39;</span><span class="p">}},</span>
 <span class="s1">&#39;Record&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;rec_ID&#39;</span><span class="p">:</span> <span class="mi">201210069849</span><span class="p">,</span>
  <span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="s1">&#39;E:/data/vid/20120409/10069849.avi&#39;</span><span class="p">,</span>
  <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;09/04/2012&#39;</span><span class="p">,</span>
  <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;21:24:07.000&#39;</span><span class="p">,</span>
  <span class="s1">&#39;speed&#39;</span><span class="p">:</span> <span class="mi">108</span><span class="p">},</span>
 <span class="s1">&#39;Speed ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Amount&#39;</span><span class="p">:</span> <span class="mi">750</span><span class="p">,</span>
  <span class="s1">&#39;Currency&#39;</span><span class="p">:</span> <span class="s1">&#39;euro&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Debtor&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;46104267P&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Felicidad&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Hidroso&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Torres&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Avenida Estiradores, N 167, 65776&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;Serrania de las Setas&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Phone number&#39;</span><span class="p">:</span> <span class="mi">555031873</span><span class="p">,</span>
   <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;23/11/1959&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Insolvency&#39;</span><span class="p">:</span> <span class="s1">&#39;No&#39;</span><span class="p">},</span>
  <span class="s1">&#39;State&#39;</span><span class="p">:</span> <span class="s1">&#39;appealed&#39;</span><span class="p">}})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pymongo.results.InsertOneResult at 0x1730abefd30&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># To check for documents where Driver.DNI and Owner.DNI have the same value, you should use the $expr operator. </span>
<span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;$and&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;Speed ticket.Amount&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$gte&quot;</span><span class="p">:</span> <span class="mi">750</span><span class="p">}},</span> 
                  <span class="p">{</span><span class="s2">&quot;$expr&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$eq&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;$vehicle.Driver.DNI&quot;</span><span class="p">,</span> <span class="s2">&quot;$vehicle.Owner.DNI&quot;</span><span class="p">]}}]}</span>
<span class="n">results_query</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">radar_tickets_collection</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">query</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_query</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;_id&#39;: &#39;A5/+274/20120409212407001&#39;,
  &#39;dump date&#39;: &#39;02/10/18&#39;,
  &#39;road&#39;: {&#39;name&#39;: &#39;A5&#39;, &#39;speed limit&#39;: 120},
  &#39;radar&#39;: {&#39;mileage&#39;: 274, &#39;direction&#39;: &#39;ascending&#39;, &#39;speed limit&#39;: 100},
  &#39;vehicle&#39;: {&#39;number plate&#39;: &#39;8828OIA&#39;,
   &#39;make&#39;: &#39;Rinaul&#39;,
   &#39;model&#39;: &#39;Manante&#39;,
   &#39;power&#39;: 1600,
   &#39;colour&#39;: &#39;gris&#39;,
   &#39;chassis number&#39;: &#39;IOI77370I57501874&#39;,
   &#39;registry date&#39;: &#39;Monday 4TH of September, 2006&#39;,
   &#39;roadworthiness&#39;: [{&#39;MOT date&#39;: &#39;13/09/2009&#39;,
     &#39;shortcomings&#39;: [&#39;damaged license plate&#39;]},
    {&#39;MOT date&#39;: &#39;16/09/2010&#39;, &#39;shortcomings&#39;: [&#39;broken hand brake&#39;]}],
   &#39;Driver&#39;: {&#39;DNI&#39;: &#39;63709185J&#39;,
    &#39;Name&#39;: &#39;Maria Quintina&#39;,
    &#39;Surname&#39;: &#39;Babilon&#39;,
    &#39;Sec_Surname&#39;: &#39;Huapaya&#39;,
    &#39;Address&#39;: &#39;Travesia del Silo, N 164, 29869&#39;,
    &#39;Town&#39;: &#39;San Juan de las Golondrinas&#39;,
    &#39;Phone number&#39;: 555582881,
    &#39;Email&#39;: &#39;Babika@servcorreo.uctreseme.edu&#39;,
    &#39;Birthdate&#39;: &#39;09/11/1991&#39;,
    &#39;driving license&#39;: {&#39;type&#39;: &#39;B&#39;, &#39;date&#39;: &#39;03/05/2008&#39;}},
   &#39;Owner&#39;: {&#39;DNI&#39;: &#39;63709185J&#39;,
    &#39;Name&#39;: &#39;Maria Quintina&#39;,
    &#39;Surname&#39;: &#39;Babilon&#39;,
    &#39;Sec_Surname&#39;: &#39;Huapaya&#39;,
    &#39;Address&#39;: &#39;Travesia del Silo, N 164, 29869&#39;,
    &#39;Town&#39;: &#39;San Juan de las Golondrinas&#39;,
    &#39;Phone number&#39;: 555582881,
    &#39;Birthdate&#39;: &#39;09/11/1991&#39;}},
  &#39;Record&#39;: {&#39;rec_ID&#39;: 201210069849,
   &#39;file&#39;: &#39;E:/data/vid/20120409/10069849.avi&#39;,
   &#39;date&#39;: &#39;09/04/2012&#39;,
   &#39;time&#39;: &#39;21:24:07.000&#39;,
   &#39;speed&#39;: 108},
  &#39;Speed ticket&#39;: {&#39;Issue date&#39;: &#39;27/04/2018&#39;,
   &#39;Amount&#39;: 850,
   &#39;Currency&#39;: &#39;euro&#39;,
   &#39;Debtor&#39;: {&#39;DNI&#39;: &#39;46104267P&#39;,
    &#39;Name&#39;: &#39;Felicidad&#39;,
    &#39;Surname&#39;: &#39;Hidroso&#39;,
    &#39;Sec_Surname&#39;: &#39;Torres&#39;,
    &#39;Address&#39;: &#39;Avenida Estiradores, N 167, 65776&#39;,
    &#39;Town&#39;: &#39;Serrania de las Setas&#39;,
    &#39;Phone number&#39;: 555031873,
    &#39;Birthdate&#39;: &#39;23/11/1959&#39;,
    &#39;Insolvency&#39;: &#39;No&#39;},
   &#39;State&#39;: &#39;appealed&#39;}},
 {&#39;_id&#39;: &#39;A5/+274/20120409212407005&#39;,
  &#39;dump date&#39;: &#39;02/10/18&#39;,
  &#39;road&#39;: {&#39;name&#39;: &#39;A5&#39;, &#39;speed limit&#39;: 120},
  &#39;radar&#39;: {&#39;mileage&#39;: 274, &#39;direction&#39;: &#39;ascending&#39;, &#39;speed limit&#39;: 100},
  &#39;vehicle&#39;: {&#39;number plate&#39;: &#39;8828OIA&#39;,
   &#39;make&#39;: &#39;Rinaul&#39;,
   &#39;model&#39;: &#39;Manante&#39;,
   &#39;power&#39;: 1600,
   &#39;colour&#39;: &#39;gris&#39;,
   &#39;chassis number&#39;: &#39;IOI77370I57501874&#39;,
   &#39;registry date&#39;: &#39;Monday 4TH of September, 2006&#39;,
   &#39;roadworthiness&#39;: [{&#39;MOT date&#39;: &#39;13/09/2009&#39;,
     &#39;shortcomings&#39;: [&#39;damaged license plate&#39;]},
    {&#39;MOT date&#39;: &#39;16/09/2010&#39;, &#39;shortcomings&#39;: [&#39;broken hand brake&#39;]}],
   &#39;Driver&#39;: {&#39;DNI&#39;: &#39;12309185X&#39;,
    &#39;Name&#39;: &#39;Pedro&#39;,
    &#39;Surname&#39;: &#39;Morata&#39;,
    &#39;Sec_Surname&#39;: &#39;Lago&#39;,
    &#39;Address&#39;: &#39;Travesia del Silo, N 164, 29869&#39;,
    &#39;Town&#39;: &#39;San Juan de las Golondrinas&#39;,
    &#39;Phone number&#39;: 552282381,
    &#39;Email&#39;: &#39;pedroML@gmail.com&#39;,
    &#39;Birthdate&#39;: &#39;09/11/1991&#39;,
    &#39;driving license&#39;: {&#39;type&#39;: &#39;B&#39;, &#39;date&#39;: &#39;04/08/2007&#39;}},
   &#39;Owner&#39;: {&#39;DNI&#39;: &#39;12309185X&#39;,
    &#39;Name&#39;: &#39;Pedro&#39;,
    &#39;Surname&#39;: &#39;Morata&#39;,
    &#39;Sec_Surname&#39;: &#39;Lago&#39;,
    &#39;Address&#39;: &#39;Travesia del Silo, N 164, 29869&#39;,
    &#39;Town&#39;: &#39;San Juan de las Golondrinas&#39;,
    &#39;Phone number&#39;: 552282381,
    &#39;Birthdate&#39;: &#39;09/11/1991&#39;}},
  &#39;Record&#39;: {&#39;rec_ID&#39;: 201210069849,
   &#39;file&#39;: &#39;E:/data/vid/20120409/10069849.avi&#39;,
   &#39;date&#39;: &#39;09/04/2012&#39;,
   &#39;time&#39;: &#39;21:24:07.000&#39;,
   &#39;speed&#39;: 108},
  &#39;Speed ticket&#39;: {&#39;Issue date&#39;: &#39;27/04/2018&#39;,
   &#39;Amount&#39;: 750,
   &#39;Currency&#39;: &#39;euro&#39;,
   &#39;Debtor&#39;: {&#39;DNI&#39;: &#39;46104267P&#39;,
    &#39;Name&#39;: &#39;Felicidad&#39;,
    &#39;Surname&#39;: &#39;Hidroso&#39;,
    &#39;Sec_Surname&#39;: &#39;Torres&#39;,
    &#39;Address&#39;: &#39;Avenida Estiradores, N 167, 65776&#39;,
    &#39;Town&#39;: &#39;Serrania de las Setas&#39;,
    &#39;Phone number&#39;: 555031873,
    &#39;Birthdate&#39;: &#39;23/11/1959&#39;,
    &#39;Insolvency&#39;: &#39;No&#39;},
   &#39;State&#39;: &#39;appealed&#39;}}]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">results_query</span><span class="p">)</span> <span class="c1"># number of documents matching the query</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
</pre></div>
</div>
</div>
</div>
<p>Including Specific Fields:</p>
<ul class="simple">
<li><p>Set the field to 1 to include it in the returned documents.</p></li>
<li><p>By default, the _id field is included. To exclude it, set it to 0.</p></li>
</ul>
<p>Excluding Specific Fields:</p>
<ul class="simple">
<li><p>Set the field to 0 to exclude it from the returned documents.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># To check for documents where Driver.DNI and Owner.DNI have the same value, you should use the $expr operator. </span>
<span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;$and&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;Speed ticket.Amount&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$gte&quot;</span><span class="p">:</span> <span class="mi">750</span><span class="p">}},</span> 
                  <span class="p">{</span><span class="s2">&quot;$expr&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$eq&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;$vehicle.Driver.DNI&quot;</span><span class="p">,</span> <span class="s2">&quot;$vehicle.Owner.DNI&quot;</span><span class="p">]}}]}</span>

<span class="n">projection</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;vehicle.Driver.DNI&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;vehicle.Owner.DNI&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;vehicle.Owner.Name&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> 
              <span class="s2">&quot;Speed ticket.Amount&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>    

<span class="n">results_query</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">radar_tickets_collection</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">projection</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_query</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;vehicle&#39;: {&#39;Driver&#39;: {&#39;DNI&#39;: &#39;63709185J&#39;},
   &#39;Owner&#39;: {&#39;DNI&#39;: &#39;63709185J&#39;, &#39;Name&#39;: &#39;Maria Quintina&#39;}},
  &#39;Speed ticket&#39;: {&#39;Amount&#39;: 850}},
 {&#39;vehicle&#39;: {&#39;Driver&#39;: {&#39;DNI&#39;: &#39;12309185X&#39;},
   &#39;Owner&#39;: {&#39;DNI&#39;: &#39;12309185X&#39;, &#39;Name&#39;: &#39;Pedro&#39;}},
  &#39;Speed ticket&#39;: {&#39;Amount&#39;: 750}}]
</pre></div>
</div>
</div>
</div>
</section>
<section id="query-2">
<h3>Query 2<a class="headerlink" href="#query-2" title="Link to this heading">#</a></h3>
<p><strong>Number plate of cars that have had a clearance ticket despite of
being reported with some problem with the brakes in some technical inspection (MOT).
You should also provide the ticket date.</strong></p>
<p>Matrícula de coches que han tenido una multa de liquidación a pesar de
haber sido denunciados con algún problema en los frenos en alguna inspección técnica (ITV).
También debe facilitar la fecha de la multa.</p>
<ul class="simple">
<li><p>First approach</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;vehicle.roadworthiness.shortcomings&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$elemMatch&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$regex&quot;</span><span class="p">:</span> <span class="s2">&quot;brak&quot;</span><span class="p">,</span><span class="s2">&quot;$options&quot;</span><span class="p">:</span> <span class="s2">&quot;i&quot;</span><span class="p">}}}</span>
<span class="c1"># &quot;i&quot; makes the regex case-insensitive</span>

<span class="n">projection</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vehicle.number plate&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>

<span class="n">query_results</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">radar_tickets_collection</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">projection</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query_results</span>
</pre></div>
</div>
</div>
</div>
<p>A sample of the query results provided running the previous cell. As before, we don’t display all the results since they are too much.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">...</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;6829IOA&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;0473AEO&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;0566EAU&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;6511IUE&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;1329EUA&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;8545AOA&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;5408EII&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;2925UEO&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;2877AIA&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;1306OEE&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;6464AIA&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;8686IUU&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;7372AEU&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;2452UEO&#39;</span><span class="p">}},</span>
 <span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
<p>The number of total results:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">query_results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19712
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>second approach</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;$and&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;vehicle.roadworthiness.shortcomings&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$elemMatch&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$regex&quot;</span><span class="p">:</span> <span class="s2">&quot;brak&quot;</span><span class="p">,</span><span class="s2">&quot;$options&quot;</span><span class="p">:</span> <span class="s2">&quot;i&quot;</span><span class="p">}}},</span>
                 <span class="p">{</span><span class="s2">&quot;Speed ticket&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$exists&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}}]}</span>
<span class="c1"># &quot;i&quot; makes the regex case-insensitive</span>

<span class="n">projection</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vehicle.number plate&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Speed ticket.Issue date&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>

<span class="n">query_results</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">radar_tickets_collection</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">projection</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query_results</span>
</pre></div>
</div>
</div>
</div>
<p>A sample of the query results provided running the previous cell. As before, we don’t display all the results since they are too much.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">...</span>
<span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;5303EIO&#39;</span><span class="p">},</span>
 <span class="s1">&#39;Speed ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">}},</span>
<span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;9454IIE&#39;</span><span class="p">},</span>
 <span class="s1">&#39;Speed ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">}},</span>
<span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;6882IUI&#39;</span><span class="p">},</span>
 <span class="s1">&#39;Speed ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">}},</span>
<span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;5867AUU&#39;</span><span class="p">},</span>
 <span class="s1">&#39;Speed ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">}},</span>
<span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;2512UAA&#39;</span><span class="p">},</span>
 <span class="s1">&#39;Speed ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">}},</span>
<span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;5853OII&#39;</span><span class="p">},</span>
 <span class="s1">&#39;Speed ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">}},</span>
<span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;9519OEE&#39;</span><span class="p">},</span>
 <span class="s1">&#39;Speed ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">}},</span>
<span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;4334OUU&#39;</span><span class="p">},</span>
 <span class="s1">&#39;Speed ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">}},</span>
<span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;0122IIA&#39;</span><span class="p">},</span>
 <span class="s1">&#39;Speed ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">}},</span>
<span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
<p>The number of total results:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">query_results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>17447
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Third approach</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;$and&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;vehicle.roadworthiness.shortcomings&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$elemMatch&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$regex&quot;</span><span class="p">:</span> <span class="s2">&quot;brak&quot;</span><span class="p">,</span><span class="s2">&quot;$options&quot;</span><span class="p">:</span> <span class="s2">&quot;i&quot;</span><span class="p">}}},</span>
                 <span class="p">{</span><span class="s2">&quot;Clearance ticket&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$exists&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}}]}</span>
<span class="c1"># &quot;i&quot; makes the regex case-insensitive</span>

<span class="n">projection</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vehicle.number plate&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Clearance ticket.Issue date&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>

<span class="n">query_results</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">radar_tickets_collection</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">projection</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query_results</span>
</pre></div>
</div>
</div>
</div>
<p>A sample of the query results provided running the previous cell.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">...</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;4286AUA&#39;</span><span class="p">},</span>
  <span class="s1">&#39;Clearance ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;5350OAE&#39;</span><span class="p">},</span>
  <span class="s1">&#39;Clearance ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;5350OAE&#39;</span><span class="p">},</span>
  <span class="s1">&#39;Clearance ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;4640EUA&#39;</span><span class="p">},</span>
  <span class="s1">&#39;Clearance ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;1369OAU&#39;</span><span class="p">},</span>
  <span class="s1">&#39;Clearance ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;1369OAU&#39;</span><span class="p">},</span>
  <span class="s1">&#39;Clearance ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;5329UEU&#39;</span><span class="p">},</span>
  <span class="s1">&#39;Clearance ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">}}</span>
  <span class="p">]</span>
</pre></div>
</div>
<p>The number of total results:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">query_results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>188
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Fourth approach</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;$and&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;vehicle.roadworthiness.shortcomings&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$elemMatch&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$regex&quot;</span><span class="p">:</span> <span class="s2">&quot;brak&quot;</span><span class="p">,</span><span class="s2">&quot;$options&quot;</span><span class="p">:</span> <span class="s2">&quot;i&quot;</span><span class="p">}}},</span>
                 <span class="p">{</span><span class="s2">&quot;Clearance ticket&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$exists&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}}]}</span>
<span class="c1"># &quot;i&quot; makes the regex case-insensitive</span>

<span class="n">projection</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vehicle.number plate&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Clearance ticket.previous car.date&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>

<span class="n">query_results</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">radar_tickets_collection</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">projection</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query_results</span>
</pre></div>
</div>
</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">...</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;4286AUA&#39;</span><span class="p">},</span>
  <span class="s1">&#39;Clearance ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;previous car&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;04/12/2016&#39;</span><span class="p">}}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;5350OAE&#39;</span><span class="p">},</span>
  <span class="s1">&#39;Clearance ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;previous car&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;25/06/2011&#39;</span><span class="p">}}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;5350OAE&#39;</span><span class="p">},</span>
  <span class="s1">&#39;Clearance ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;previous car&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;24/06/2017&#39;</span><span class="p">}}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;4640EUA&#39;</span><span class="p">},</span>
  <span class="s1">&#39;Clearance ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;previous car&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;21/09/2017&#39;</span><span class="p">}}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;1369OAU&#39;</span><span class="p">},</span>
  <span class="s1">&#39;Clearance ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;previous car&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;03/03/2011&#39;</span><span class="p">}}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;1369OAU&#39;</span><span class="p">},</span>
  <span class="s1">&#39;Clearance ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;previous car&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;08/07/2016&#39;</span><span class="p">}}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;5329UEU&#39;</span><span class="p">},</span>
  <span class="s1">&#39;Clearance ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;previous car&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/06/2017&#39;</span><span class="p">}}}</span>
  <span class="p">]</span>
</pre></div>
</div>
<p>Testing results: inserting documents that match the query but have an ‘Issue date’ different to ‘27/04/2018’</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">radar_tickets_collection</span><span class="o">.</span><span class="n">insert_one</span><span class="p">({</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="s1">&#39;A1/+218/20140126204716001&#39;</span><span class="p">,</span>
 <span class="s1">&#39;dump date&#39;</span><span class="p">:</span> <span class="s1">&#39;02/10/18&#39;</span><span class="p">,</span>
 <span class="s1">&#39;road&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;speed limit&#39;</span><span class="p">:</span> <span class="mi">120</span><span class="p">},</span>
 <span class="s1">&#39;radar&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;mileage&#39;</span><span class="p">:</span> <span class="mi">218</span><span class="p">,</span> <span class="s1">&#39;direction&#39;</span><span class="p">:</span> <span class="s1">&#39;ascending&#39;</span><span class="p">,</span> <span class="s1">&#39;speed limit&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">},</span>
 <span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;4483AIO&#39;</span><span class="p">,</span>
  <span class="s1">&#39;make&#39;</span><span class="p">:</span> <span class="s1">&#39;Merche&#39;</span><span class="p">,</span>
  <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;Berlin&#39;</span><span class="p">,</span>
  <span class="s1">&#39;power&#39;</span><span class="p">:</span> <span class="mi">1400</span><span class="p">,</span>
  <span class="s1">&#39;colour&#39;</span><span class="p">:</span> <span class="s1">&#39;negro metalizado&#39;</span><span class="p">,</span>
  <span class="s1">&#39;chassis number&#39;</span><span class="p">:</span> <span class="s1">&#39;IOQ90947Q76497060&#39;</span><span class="p">,</span>
  <span class="s1">&#39;registry date&#39;</span><span class="p">:</span> <span class="s1">&#39;Wednesday 5TH of October, 2005&#39;</span><span class="p">,</span>
  <span class="s1">&#39;roadworthiness&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;MOT date&#39;</span><span class="p">:</span> <span class="s1">&#39;07/02/2010&#39;</span><span class="p">},</span>
   <span class="p">{</span><span class="s1">&#39;MOT date&#39;</span><span class="p">:</span> <span class="s1">&#39;11/01/2010&#39;</span><span class="p">},</span>
   <span class="p">{</span><span class="s1">&#39;MOT date&#39;</span><span class="p">:</span> <span class="s1">&#39;24/01/2012&#39;</span><span class="p">,</span>
    <span class="s1">&#39;shortcomings&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;damaged license plate&#39;</span><span class="p">,</span>
     <span class="s1">&#39;damaged chassis&#39;</span><span class="p">,</span>
     <span class="s1">&#39;insufficient braking&#39;</span><span class="p">]}],</span>
  <span class="s1">&#39;Driver&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;26322160V&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Luis&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Pedreros&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Sarrin&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Calle de los Jazmines, N 39, 64503&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;Sotosetas&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Phone number&#39;</span><span class="p">:</span> <span class="mi">555561625</span><span class="p">,</span>
   <span class="s1">&#39;Email&#39;</span><span class="p">:</span> <span class="s1">&#39;Whooper@servcorreo.uctreseme.edu&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;18/03/1977&#39;</span><span class="p">,</span>
   <span class="s1">&#39;driving license&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;20/08/1989&#39;</span><span class="p">}},</span>
  <span class="s1">&#39;Owner&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;15742171M&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Maria de la Consolacion&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Garcia&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Pomar&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Calle del Silo, N 28, 64122&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;Sotolobos&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Phone number&#39;</span><span class="p">:</span> <span class="mi">555985301</span><span class="p">,</span>
   <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;30/01/1961&#39;</span><span class="p">}},</span>
 <span class="s1">&#39;Record&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;rec_ID&#39;</span><span class="p">:</span> <span class="mi">201402669351</span><span class="p">,</span>
  <span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="s1">&#39;E:/data/vid/20140126/10069351.avi&#39;</span><span class="p">,</span>
  <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;26/01/2014&#39;</span><span class="p">,</span>
  <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;20:47:16.000&#39;</span><span class="p">,</span>
  <span class="s1">&#39;speed&#39;</span><span class="p">:</span> <span class="mi">95</span><span class="p">},</span>
 <span class="s1">&#39;Clearance ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;previous car&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;6560AII&#39;</span><span class="p">,</span>
   <span class="s1">&#39;make&#39;</span><span class="p">:</span> <span class="s1">&#39;Fork&#39;</span><span class="p">,</span>
   <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;Tetrox&#39;</span><span class="p">,</span>
   <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;26/01/2014&#39;</span><span class="p">,</span>
   <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;20:47:15.000&#39;</span><span class="p">},</span>
  <span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;05/11/2020&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Amount&#39;</span><span class="p">:</span> <span class="mi">188</span><span class="p">,</span>
  <span class="s1">&#39;Currency&#39;</span><span class="p">:</span> <span class="s1">&#39;euro&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Debtor&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;15742171M&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Maria de la Consolacion&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Garcia&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Pomar&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Calle del Silo, N 28, 64122&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;Sotolobos&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Phone number&#39;</span><span class="p">:</span> <span class="mi">555985301</span><span class="p">,</span>
   <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;30/01/1961&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Insolvency&#39;</span><span class="p">:</span> <span class="s1">&#39;No&#39;</span><span class="p">},</span>
  <span class="s1">&#39;Pay date&#39;</span><span class="p">:</span> <span class="s1">&#39;03/05/2018&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Pay type&#39;</span><span class="p">:</span> <span class="s1">&#39;bank transfer&#39;</span><span class="p">,</span>
  <span class="s1">&#39;State&#39;</span><span class="p">:</span> <span class="s1">&#39;fullfilled&#39;</span><span class="p">}})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pymongo.results.InsertOneResult at 0x1738af6d570&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;$and&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;vehicle.roadworthiness.shortcomings&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$elemMatch&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$regex&quot;</span><span class="p">:</span> <span class="s2">&quot;brak&quot;</span><span class="p">,</span><span class="s2">&quot;$options&quot;</span><span class="p">:</span> <span class="s2">&quot;i&quot;</span><span class="p">}}},</span>
                 <span class="p">{</span><span class="s2">&quot;Clearance ticket&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$exists&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}}]}</span>
<span class="c1"># &quot;i&quot; makes the regex case-insensitive</span>

<span class="n">projection</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vehicle.number plate&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Clearance ticket.Issue date&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>

<span class="n">query_results</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">radar_tickets_collection</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">projection</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query_results</span>
</pre></div>
</div>
</div>
</div>
<p>A sample of the query results provided running the previous cell.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">...</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;1131AOO&#39;</span><span class="p">},</span>
  <span class="s1">&#39;Clearance ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;4286AUA&#39;</span><span class="p">},</span>
  <span class="s1">&#39;Clearance ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;5350OAE&#39;</span><span class="p">},</span>
  <span class="s1">&#39;Clearance ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;5350OAE&#39;</span><span class="p">},</span>
  <span class="s1">&#39;Clearance ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;4640EUA&#39;</span><span class="p">},</span>
  <span class="s1">&#39;Clearance ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;1369OAU&#39;</span><span class="p">},</span>
  <span class="s1">&#39;Clearance ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;1369OAU&#39;</span><span class="p">},</span>
  <span class="s1">&#39;Clearance ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;5329UEU&#39;</span><span class="p">},</span>
  <span class="s1">&#39;Clearance ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;4483AIO&#39;</span><span class="p">},</span>
  <span class="s1">&#39;Clearance ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;05/11/2020&#39;</span><span class="p">}}</span>
  <span class="p">]</span>
</pre></div>
</div>
</section>
<section id="query-3">
<h3>Query 3<a class="headerlink" href="#query-3" title="Link to this heading">#</a></h3>
<p><strong>For each month of the year, group the drivers who
were born in that month, and calculate their average speed and their total amount of
tickets. Naturally, the output has 12 documents (sort from January to December), unless
some month has no driver recorded…</strong></p>
<p>Tip: nobody says you have to display the name of the months (you can use a number…)</p>
<ul class="simple">
<li><p>First approach</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;vehicle.Driver.Birthdate&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$regex&quot;</span><span class="p">:</span> <span class="s2">&quot;/11/&quot;</span><span class="p">,</span> <span class="s2">&quot;$options&quot;</span><span class="p">:</span> <span class="s2">&quot;i&quot;</span><span class="p">}}</span>

<span class="n">projection</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vehicle.Driver.DNI&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;vehicle.Driver.Birthdate&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Record.speed&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Speed ticket.amount&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>

<span class="n">query_results</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">radar_tickets_collection</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">projection</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>query_results</p>
<ul class="simple">
<li><p>Second approach</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;$project&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;month_of_birth&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$substr&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;$vehicle.Driver.Birthdate&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]},</span> <span class="c1"># Extract month from Birthdate </span>
                          <span class="s2">&quot;speed&quot;</span><span class="p">:</span> <span class="s2">&quot;$Record.speed&quot;</span><span class="p">,</span> <span class="c1"># Extract speed from Record</span>
                          <span class="s2">&quot;ticket_amount&quot;</span><span class="p">:</span> <span class="s2">&quot;$Speed ticket.Amount&quot;</span> <span class="c1"># Extract ticket amount (in €)</span>
                          <span class="p">}</span> 
            <span class="p">},</span> 
            <span class="p">{</span><span class="s2">&quot;$group&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="s2">&quot;$month_of_birth&quot;</span><span class="p">,</span>  <span class="c1"># Group by month</span>
                        <span class="s2">&quot;average_speed&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$avg&quot;</span><span class="p">:</span> <span class="s2">&quot;$speed&quot;</span><span class="p">},</span>  <span class="c1"># Calculate average speed</span>
                        <span class="s2">&quot;total_amount_tickets&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$sum&quot;</span><span class="p">:</span> <span class="s2">&quot;$ticket_amount&quot;</span><span class="p">},</span>  <span class="c1"># Calculate total tickets amount </span>
                        <span class="p">}</span>
            <span class="p">},</span>
            <span class="p">{</span><span class="s2">&quot;$sort&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}}</span> <span class="c1"># Sort by month in ascending order</span>
            <span class="p">]</span>  

<span class="n">query_results</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">radar_tickets_collection</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">pipeline</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query_results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;_id&#39;: &#39;01&#39;,
  &#39;average_speed&#39;: 104.76378169790519,
  &#39;total_amount_tickets&#39;: 538990},
 {&#39;_id&#39;: &#39;02&#39;,
  &#39;average_speed&#39;: 104.62826797385621,
  &#39;total_amount_tickets&#39;: 517150},
 {&#39;_id&#39;: &#39;03&#39;,
  &#39;average_speed&#39;: 104.79309506442986,
  &#39;total_amount_tickets&#39;: 607850},
 {&#39;_id&#39;: &#39;04&#39;,
  &#39;average_speed&#39;: 104.36586257309942,
  &#39;total_amount_tickets&#39;: 817810},
 {&#39;_id&#39;: &#39;05&#39;,
  &#39;average_speed&#39;: 103.52604075944957,
  &#39;total_amount_tickets&#39;: 850230},
 {&#39;_id&#39;: &#39;06&#39;,
  &#39;average_speed&#39;: 104.64609236234459,
  &#39;total_amount_tickets&#39;: 651570},
 {&#39;_id&#39;: &#39;07&#39;,
  &#39;average_speed&#39;: 103.49527576356844,
  &#39;total_amount_tickets&#39;: 664580},
 {&#39;_id&#39;: &#39;08&#39;,
  &#39;average_speed&#39;: 104.94220509780676,
  &#39;total_amount_tickets&#39;: 511870},
 {&#39;_id&#39;: &#39;09&#39;,
  &#39;average_speed&#39;: 105.54202116621705,
  &#39;total_amount_tickets&#39;: 728210},
 {&#39;_id&#39;: &#39;10&#39;,
  &#39;average_speed&#39;: 103.83906931652933,
  &#39;total_amount_tickets&#39;: 285580},
 {&#39;_id&#39;: &#39;11&#39;,
  &#39;average_speed&#39;: 105.37641288121135,
  &#39;total_amount_tickets&#39;: 698875},
 {&#39;_id&#39;: &#39;12&#39;,
  &#39;average_speed&#39;: 104.39550029603316,
  &#39;total_amount_tickets&#39;: 483750}]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">query_results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12
</pre></div>
</div>
</div>
</div>
<p>Some explanations:</p>
<ul class="simple">
<li><p>{”<span class="math notranslate nohighlight">\(substr&quot;: [&quot;\)</span>vehicle.Driver.Birthdate”, 3, 2]}</p>
<ul>
<li><p>“$substr”: This is the MongoDB operator used to get a substring of a string field.</p></li>
<li><p>“$vehicle.Driver.Birthdate”: This is the field from which the substring will be extracted. Assuming that Birthdate is stored in the format “dd/mm/yyyy”, this operation is targeting the month portion.</p></li>
<li><p>3: This is the starting index of the substring. Indices start at 0, so an index of 3 points to the first character of the month (e.g., in “16/02/1991”, it points to the first “0” in “02”).</p></li>
<li><p>2: This is the length of the substring. Since a month in “dd/mm/yyyy” format is represented by two characters (like “02” for February), the length is 2.</p></li>
</ul>
</li>
</ul>
</section>
<section id="query-4">
<h3>Query 4<a class="headerlink" href="#query-4" title="Link to this heading">#</a></h3>
<p><strong>For each road, percentages of recordings with a ticket of
each type (regarding total observations in that road).</strong></p>
<p>Tip: each recording can have several tickets, but at most one of each type</p>
<p>Para cada carretera, porcentajes de registros con una multa de
cada tipo (respecto al total de observaciones en esa carretera).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;$project&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;road_name&quot;</span><span class="p">:</span> <span class="s2">&quot;$road.name&quot;</span><span class="p">,</span>
            <span class="s2">&quot;clearance_ticket_exists&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$cond&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;$ifNull&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;$Clearance ticket&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">]},</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]},</span>
            <span class="s2">&quot;speed_ticket_exists&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$cond&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;$ifNull&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;$Speed ticket&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">]},</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]},</span>
            <span class="s2">&quot;stretch_ticket_exists&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$cond&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;$ifNull&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;$Stretch ticket&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">]},</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;$group&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="s2">&quot;$road_name&quot;</span><span class="p">,</span>
            <span class="s2">&quot;total_records&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$sum&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
            <span class="s2">&quot;clearance_ticket_count&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$sum&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$cond&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;$clearance_ticket_exists&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]}},</span>
            <span class="s2">&quot;speed_ticket_count&quot;</span> <span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$sum&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$cond&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;$speed_ticket_exists&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]}},</span>
            <span class="s2">&quot;stretch_ticket_count&quot;</span> <span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$sum&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$cond&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;$stretch_ticket_exists&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]}}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;$addFields&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;clearance_tickets_prop&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$round&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;$divide&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;$clearance_ticket_count&quot;</span><span class="p">,</span> <span class="s2">&quot;$total_records&quot;</span><span class="p">]},</span> <span class="mi">4</span><span class="p">]},</span>
            <span class="s2">&quot;speed_tickets_prop&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$round&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;$divide&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;$speed_ticket_count&quot;</span><span class="p">,</span> <span class="s2">&quot;$total_records&quot;</span><span class="p">]},</span> <span class="mi">4</span><span class="p">]},</span>
            <span class="s2">&quot;stretch_tickets_prop&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$round&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;$divide&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;$stretch_ticket_count&quot;</span><span class="p">,</span> <span class="s2">&quot;$total_records&quot;</span><span class="p">]},</span> <span class="mi">4</span><span class="p">]},</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
    <span class="s2">&quot;$addFields&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;no_ticket_prop&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$round&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;$subtract&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;$add&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;$clearance_tickets_prop&quot;</span><span class="p">,</span> 
                                                                  <span class="s2">&quot;$speed_tickets_prop&quot;</span><span class="p">,</span> 
                                                                  <span class="s2">&quot;$stretch_tickets_prop&quot;</span><span class="p">]}]},</span> <span class="mi">4</span><span class="p">]}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;$project&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;road_name&quot;</span><span class="p">:</span> <span class="s2">&quot;$_id&quot;</span><span class="p">,</span>  
                     <span class="s2">&quot;clearance_tickets_prop&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                     <span class="s2">&quot;speed_tickets_prop&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                     <span class="s2">&quot;stretch_tickets_prop&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> 
                     <span class="s2">&quot;no_ticket_prop&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
    <span class="p">}</span>
<span class="p">]</span>

<span class="n">query_results</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">radar_tickets_collection</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">pipeline</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query_results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;_id&#39;: &#39;A6&#39;,
  &#39;clearance_tickets_prop&#39;: 0.0101,
  &#39;speed_tickets_prop&#39;: 0.866,
  &#39;stretch_tickets_prop&#39;: 0.0101,
  &#39;no_ticket_prop&#39;: 0.1138,
  &#39;road_name&#39;: &#39;A6&#39;},
 {&#39;_id&#39;: &#39;M40&#39;,
  &#39;clearance_tickets_prop&#39;: 0.0108,
  &#39;speed_tickets_prop&#39;: 0.8877,
  &#39;stretch_tickets_prop&#39;: 0.0045,
  &#39;no_ticket_prop&#39;: 0.097,
  &#39;road_name&#39;: &#39;M40&#39;},
 {&#39;_id&#39;: &#39;A2&#39;,
  &#39;clearance_tickets_prop&#39;: 0.0097,
  &#39;speed_tickets_prop&#39;: 0.8914,
  &#39;stretch_tickets_prop&#39;: 0.0131,
  &#39;no_ticket_prop&#39;: 0.0858,
  &#39;road_name&#39;: &#39;A2&#39;},
 {&#39;_id&#39;: &#39;A4&#39;,
  &#39;clearance_tickets_prop&#39;: 0.0081,
  &#39;speed_tickets_prop&#39;: 0.9094,
  &#39;stretch_tickets_prop&#39;: 0.0097,
  &#39;no_ticket_prop&#39;: 0.0728,
  &#39;road_name&#39;: &#39;A4&#39;},
 {&#39;_id&#39;: &#39;M30&#39;,
  &#39;clearance_tickets_prop&#39;: 0.0098,
  &#39;speed_tickets_prop&#39;: 0.9018,
  &#39;stretch_tickets_prop&#39;: 0.0082,
  &#39;no_ticket_prop&#39;: 0.0802,
  &#39;road_name&#39;: &#39;M30&#39;},
 {&#39;_id&#39;: &#39;M50&#39;,
  &#39;clearance_tickets_prop&#39;: 0.0064,
  &#39;speed_tickets_prop&#39;: 0.8835,
  &#39;stretch_tickets_prop&#39;: 0.0074,
  &#39;no_ticket_prop&#39;: 0.1027,
  &#39;road_name&#39;: &#39;M50&#39;},
 {&#39;_id&#39;: &#39;A3&#39;,
  &#39;clearance_tickets_prop&#39;: 0.0094,
  &#39;speed_tickets_prop&#39;: 0.8809,
  &#39;stretch_tickets_prop&#39;: 0.0138,
  &#39;no_ticket_prop&#39;: 0.0959,
  &#39;road_name&#39;: &#39;A3&#39;},
 {&#39;_id&#39;: &#39;A5&#39;,
  &#39;clearance_tickets_prop&#39;: 0.0069,
  &#39;speed_tickets_prop&#39;: 0.8608,
  &#39;stretch_tickets_prop&#39;: 0.0097,
  &#39;no_ticket_prop&#39;: 0.1226,
  &#39;road_name&#39;: &#39;A5&#39;},
 {&#39;_id&#39;: &#39;A1&#39;,
  &#39;clearance_tickets_prop&#39;: 0.0114,
  &#39;speed_tickets_prop&#39;: 0.8739,
  &#39;stretch_tickets_prop&#39;: 0.0077,
  &#39;no_ticket_prop&#39;: 0.107,
  &#39;road_name&#39;: &#39;A1&#39;},
 {&#39;_id&#39;: &#39;M45&#39;,
  &#39;clearance_tickets_prop&#39;: 0.009,
  &#39;speed_tickets_prop&#39;: 0.8797,
  &#39;stretch_tickets_prop&#39;: 0.003,
  &#39;no_ticket_prop&#39;: 0.1083,
  &#39;road_name&#39;: &#39;M45&#39;}]
</pre></div>
</div>
</div>
</div>
</section>
<section id="query-5">
<h3>Query 5<a class="headerlink" href="#query-5" title="Link to this heading">#</a></h3>
<p><strong>For each type of a problem (in a MOT), specify the most
frequent make and model (be careful: the same car could have several recordings…).</strong></p>
<p>Tip: make and model is an identifier (can be a single “column”)</p>
<ul class="simple">
<li><p>First approach</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># Unwind the roadworthiness array</span>
    <span class="p">{</span><span class="s2">&quot;$unwind&quot;</span><span class="p">:</span> <span class="s2">&quot;$vehicle.roadworthiness&quot;</span><span class="p">},</span>
    
    <span class="c1"># Unwind the shortcomings array</span>
    <span class="p">{</span><span class="s2">&quot;$unwind&quot;</span><span class="p">:</span> <span class="s2">&quot;$vehicle.roadworthiness.shortcomings&quot;</span><span class="p">}</span>
    
<span class="p">]</span>

<span class="n">results_query</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">radar_tickets_collection</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">pipeline</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_query</span>
</pre></div>
</div>
</div>
</div>
<p>A sample of the query results provided running the previous cell.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">...</span>
<span class="p">{</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="s1">&#39;A2/+10/20101127190005820&#39;</span><span class="p">,</span>
  <span class="s1">&#39;dump date&#39;</span><span class="p">:</span> <span class="s1">&#39;02/10/18&#39;</span><span class="p">,</span>
  <span class="s1">&#39;road&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;speed limit&#39;</span><span class="p">:</span> <span class="mi">120</span><span class="p">},</span>
  <span class="s1">&#39;radar&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;mileage&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;direction&#39;</span><span class="p">:</span> <span class="s1">&#39;ascending&#39;</span><span class="p">,</span> <span class="s1">&#39;speed limit&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">},</span>
  <span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;6525AEI&#39;</span><span class="p">,</span>
   <span class="s1">&#39;make&#39;</span><span class="p">:</span> <span class="s1">&#39;Zitron&#39;</span><span class="p">,</span>
   <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;Lemmon&#39;</span><span class="p">,</span>
   <span class="s1">&#39;power&#39;</span><span class="p">:</span> <span class="mi">1400</span><span class="p">,</span>
   <span class="s1">&#39;colour&#39;</span><span class="p">:</span> <span class="s1">&#39;azul&#39;</span><span class="p">,</span>
   <span class="s1">&#39;chassis number&#39;</span><span class="p">:</span> <span class="s1">&#39;OIO64678O93280477&#39;</span><span class="p">,</span>
   <span class="s1">&#39;registry date&#39;</span><span class="p">:</span> <span class="s1">&#39;Tuesday 30TH of March, 2004&#39;</span><span class="p">,</span>
   <span class="s1">&#39;roadworthiness&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;MOT date&#39;</span><span class="p">:</span> <span class="s1">&#39;06/11/2011&#39;</span><span class="p">,</span>
    <span class="s1">&#39;shortcomings&#39;</span><span class="p">:</span> <span class="s1">&#39;broken hand brake&#39;</span><span class="p">},</span>
   <span class="s1">&#39;Driver&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;87980168Q&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Jesus Diego&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Bullon&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Wong&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Calle San Millan, N 27, 35739&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;Valseca del Secano&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Phone number&#39;</span><span class="p">:</span> <span class="mi">555065167</span><span class="p">,</span>
    <span class="s1">&#39;Email&#39;</span><span class="p">:</span> <span class="s1">&#39;Kiko@servcorreo.uctreseme.edu&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;27/06/1955&#39;</span><span class="p">,</span>
    <span class="s1">&#39;driving license&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;19/06/2004&#39;</span><span class="p">}},</span>
   <span class="s1">&#39;Owner&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;87980168Q&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Jesus Diego&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Bullon&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Wong&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Calle San Millan, N 27, 35739&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;Valseca del Secano&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Phone number&#39;</span><span class="p">:</span> <span class="mi">555065167</span><span class="p">,</span>
    <span class="s1">&#39;Email&#39;</span><span class="p">:</span> <span class="s1">&#39;Kiko@servcorreo.uctreseme.edu&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;27/06/1955&#39;</span><span class="p">}},</span>
  <span class="s1">&#39;Record&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;rec_ID&#39;</span><span class="p">:</span> <span class="mi">201033169742</span><span class="p">,</span>
   <span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="s1">&#39;E:/data/vid/20101127/10069742.avi&#39;</span><span class="p">,</span>
   <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/11/2010&#39;</span><span class="p">,</span>
   <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;19:00:05.820&#39;</span><span class="p">,</span>
   <span class="s1">&#39;speed&#39;</span><span class="p">:</span> <span class="mi">116</span><span class="p">},</span>
  <span class="s1">&#39;Speed ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Amount&#39;</span><span class="p">:</span> <span class="mi">160</span><span class="p">,</span>
   <span class="s1">&#39;Currency&#39;</span><span class="p">:</span> <span class="s1">&#39;euro&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Debtor&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;87980168Q&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Jesus Diego&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Bullon&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Wong&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Calle San Millan, N 27, 35739&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;Valseca del Secano&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Phone number&#39;</span><span class="p">:</span> <span class="mi">555065167</span><span class="p">,</span>
    <span class="s1">&#39;Email&#39;</span><span class="p">:</span> <span class="s1">&#39;Kiko@servcorreo.uctreseme.edu&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;27/06/1955&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Insolvency&#39;</span><span class="p">:</span> <span class="s1">&#39;No&#39;</span><span class="p">},</span>
   <span class="s1">&#39;Pay date&#39;</span><span class="p">:</span> <span class="s1">&#39;09/05/2018&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Pay type&#39;</span><span class="p">:</span> <span class="s1">&#39;cash&#39;</span><span class="p">,</span>
   <span class="s1">&#39;State&#39;</span><span class="p">:</span> <span class="s1">&#39;fullfilled&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="s1">&#39;A4/+54/20110604133704990&#39;</span><span class="p">,</span>
  <span class="s1">&#39;dump date&#39;</span><span class="p">:</span> <span class="s1">&#39;02/10/18&#39;</span><span class="p">,</span>
  <span class="s1">&#39;road&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;A4&#39;</span><span class="p">,</span> <span class="s1">&#39;speed limit&#39;</span><span class="p">:</span> <span class="mi">120</span><span class="p">},</span>
  <span class="s1">&#39;radar&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;mileage&#39;</span><span class="p">:</span> <span class="mi">54</span><span class="p">,</span> <span class="s1">&#39;direction&#39;</span><span class="p">:</span> <span class="s1">&#39;ascending&#39;</span><span class="p">,</span> <span class="s1">&#39;speed limit&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">},</span>
  <span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;number plate&#39;</span><span class="p">:</span> <span class="s1">&#39;2347OUI&#39;</span><span class="p">,</span>
   <span class="s1">&#39;make&#39;</span><span class="p">:</span> <span class="s1">&#39;Peuyo&#39;</span><span class="p">,</span>
   <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;Natural&#39;</span><span class="p">,</span>
   <span class="s1">&#39;power&#39;</span><span class="p">:</span> <span class="mi">1400</span><span class="p">,</span>
   <span class="s1">&#39;colour&#39;</span><span class="p">:</span> <span class="s1">&#39;rojo metalizado&#39;</span><span class="p">,</span>
   <span class="s1">&#39;chassis number&#39;</span><span class="p">:</span> <span class="s1">&#39;IIQ34933Q76160605&#39;</span><span class="p">,</span>
   <span class="s1">&#39;registry date&#39;</span><span class="p">:</span> <span class="s1">&#39;Sunday 10TH of July, 2005&#39;</span><span class="p">,</span>
   <span class="s1">&#39;roadworthiness&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;MOT date&#39;</span><span class="p">:</span> <span class="s1">&#39;17/01/2010&#39;</span><span class="p">,</span>
    <span class="s1">&#39;shortcomings&#39;</span><span class="p">:</span> <span class="s1">&#39;windshield in poor condition&#39;</span><span class="p">},</span>
   <span class="s1">&#39;Driver&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;31414734T&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Maria Clotilde&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Mendoza&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Gomez&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Avenida de los alamos, N 68, 11006&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;Sotolemures de la Noceda&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Phone number&#39;</span><span class="p">:</span> <span class="mi">555654658</span><span class="p">,</span>
    <span class="s1">&#39;Email&#39;</span><span class="p">:</span> <span class="s1">&#39;Cloty@servcorreo.uctreseme.edu&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;25/05/1951&#39;</span><span class="p">,</span>
    <span class="s1">&#39;driving license&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;01/10/2002&#39;</span><span class="p">}},</span>
   <span class="s1">&#39;Owner&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;32609826N&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Cayetano&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Almeida&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Kuyeng&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Travesia Estiradores, N 96, 78109&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;Villachimeneas de los Viajeros&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Phone number&#39;</span><span class="p">:</span> <span class="mi">555256042</span><span class="p">,</span>
    <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;29/10/1968&#39;</span><span class="p">}},</span>
  <span class="s1">&#39;Record&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;rec_ID&#39;</span><span class="p">:</span> <span class="mi">201115569741</span><span class="p">,</span>
   <span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="s1">&#39;E:/data/vid/20110604/10069741.avi&#39;</span><span class="p">,</span>
   <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;04/06/2011&#39;</span><span class="p">,</span>
   <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;13:37:04.990&#39;</span><span class="p">,</span>
   <span class="s1">&#39;speed&#39;</span><span class="p">:</span> <span class="mi">118</span><span class="p">},</span>
  <span class="s1">&#39;Speed ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Issue date&#39;</span><span class="p">:</span> <span class="s1">&#39;27/04/2018&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Amount&#39;</span><span class="p">:</span> <span class="mi">180</span><span class="p">,</span>
   <span class="s1">&#39;Currency&#39;</span><span class="p">:</span> <span class="s1">&#39;euro&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Debtor&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;32609826N&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Cayetano&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Almeida&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Sec_Surname&#39;</span><span class="p">:</span> <span class="s1">&#39;Kuyeng&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Address&#39;</span><span class="p">:</span> <span class="s1">&#39;Travesia Estiradores, N 96, 78109&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Town&#39;</span><span class="p">:</span> <span class="s1">&#39;Villachimeneas de los Viajeros&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Phone number&#39;</span><span class="p">:</span> <span class="mi">555256042</span><span class="p">,</span>
    <span class="s1">&#39;Birthdate&#39;</span><span class="p">:</span> <span class="s1">&#39;29/10/1968&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Insolvency&#39;</span><span class="p">:</span> <span class="s1">&#39;No&#39;</span><span class="p">},</span>
   <span class="s1">&#39;Pay date&#39;</span><span class="p">:</span> <span class="s1">&#39;07/05/2018&#39;</span><span class="p">,</span>
   <span class="s1">&#39;Pay type&#39;</span><span class="p">:</span> <span class="s1">&#39;cash&#39;</span><span class="p">,</span>
   <span class="s1">&#39;State&#39;</span><span class="p">:</span> <span class="s1">&#39;fullfilled&#39;</span><span class="p">}},</span>
 <span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
<p>Understanding <code class="docutils literal notranslate"><span class="pre">$unwind</span></code> operation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
  <span class="p">{</span>
  <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">]</span>
  <span class="p">},</span>
  <span class="p">{</span>
   <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
  <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;J&quot;</span><span class="p">,</span> <span class="s2">&quot;K&quot;</span><span class="p">]</span>   
  <span class="p">}</span>
<span class="p">]</span>

<span class="c1">###############################</span>

<span class="p">{</span> <span class="s2">&quot;$unwind&quot;</span><span class="p">:</span> <span class="s2">&quot;$items&quot;</span> <span class="p">}</span>

<span class="c1">###############################</span>

<span class="p">{</span> <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="s2">&quot;C&quot;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="s2">&quot;H&quot;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="s2">&quot;J&quot;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="s2">&quot;K&quot;</span> <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;_id&#39;: 2, &#39;items&#39;: &#39;K&#39;}
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Second approach</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># Unwind the roadworthiness array</span>
    <span class="p">{</span><span class="s2">&quot;$unwind&quot;</span><span class="p">:</span> <span class="s2">&quot;$vehicle.roadworthiness&quot;</span><span class="p">},</span>
    
    <span class="c1"># Unwind the shortcomings array</span>
    <span class="p">{</span><span class="s2">&quot;$unwind&quot;</span><span class="p">:</span> <span class="s2">&quot;$vehicle.roadworthiness.shortcomings&quot;</span><span class="p">},</span>
    
    <span class="c1"># Group by shortcomings and vehicle make-model to count occurrences</span>
    <span class="p">{</span>
        <span class="s2">&quot;$group&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;shortcoming&quot;</span><span class="p">:</span> <span class="s2">&quot;$vehicle.roadworthiness.shortcomings&quot;</span><span class="p">,</span>
                <span class="s2">&quot;make&quot;</span><span class="p">:</span> <span class="s2">&quot;$vehicle.make&quot;</span><span class="p">,</span>
                <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="s2">&quot;$vehicle.model&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$sum&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    
    <span class="c1"># Sort by shortcoming and descending count</span>
    <span class="p">{</span>
        <span class="s2">&quot;$sort&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;_id.shortcoming&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">]</span>

<span class="n">results_query</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">radar_tickets_collection</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">pipeline</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_query</span>
</pre></div>
</div>
</div>
</div>
<p>A sample of the query results provided running the previous cell.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">...</span><span class="p">,</span>
 <span class="p">{</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;shortcoming&#39;</span><span class="p">:</span> <span class="s1">&#39;worn tires&#39;</span><span class="p">,</span> <span class="s1">&#39;make&#39;</span><span class="p">:</span> <span class="s1">&#39;Peuyo&#39;</span><span class="p">,</span> <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;Entero&#39;</span><span class="p">},</span>
  <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="mi">283</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;shortcoming&#39;</span><span class="p">:</span> <span class="s1">&#39;worn tires&#39;</span><span class="p">,</span> <span class="s1">&#39;make&#39;</span><span class="p">:</span> <span class="s1">&#39;Rinaul&#39;</span><span class="p">,</span> <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;Arroyo&#39;</span><span class="p">},</span>
  <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="mi">281</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;shortcoming&#39;</span><span class="p">:</span> <span class="s1">&#39;worn tires&#39;</span><span class="p">,</span> <span class="s1">&#39;make&#39;</span><span class="p">:</span> <span class="s1">&#39;Rinaul&#39;</span><span class="p">,</span> <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;Manante&#39;</span><span class="p">},</span>
  <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="mi">219</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;shortcoming&#39;</span><span class="p">:</span> <span class="s1">&#39;worn tires&#39;</span><span class="p">,</span> <span class="s1">&#39;make&#39;</span><span class="p">:</span> <span class="s1">&#39;Escola&#39;</span><span class="p">,</span> <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;Tercius&#39;</span><span class="p">},</span>
  <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="mi">209</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;shortcoming&#39;</span><span class="p">:</span> <span class="s1">&#39;worn tires&#39;</span><span class="p">,</span> <span class="s1">&#39;make&#39;</span><span class="p">:</span> <span class="s1">&#39;Bemev&#39;</span><span class="p">,</span> <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;K-brio&#39;</span><span class="p">},</span>
  <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="mi">179</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;shortcoming&#39;</span><span class="p">:</span> <span class="s1">&#39;worn tires&#39;</span><span class="p">,</span> <span class="s1">&#39;make&#39;</span><span class="p">:</span> <span class="s1">&#39;Escola&#39;</span><span class="p">,</span> <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;Cuartus&#39;</span><span class="p">},</span>
  <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="mi">136</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;shortcoming&#39;</span><span class="p">:</span> <span class="s1">&#39;worn tires&#39;</span><span class="p">,</span> <span class="s1">&#39;make&#39;</span><span class="p">:</span> <span class="s1">&#39;Fork&#39;</span><span class="p">,</span> <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;Bipua&#39;</span><span class="p">},</span>
  <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="mi">127</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;shortcoming&#39;</span><span class="p">:</span> <span class="s1">&#39;worn tires&#39;</span><span class="p">,</span> <span class="s1">&#39;make&#39;</span><span class="p">:</span> <span class="s1">&#39;Fork&#39;</span><span class="p">,</span> <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;Tridente&#39;</span><span class="p">},</span>
  <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="mi">65</span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Third approach</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># Unwind the roadworthiness array</span>
    <span class="p">{</span><span class="s2">&quot;$unwind&quot;</span><span class="p">:</span> <span class="s2">&quot;$vehicle.roadworthiness&quot;</span><span class="p">},</span>
    
    <span class="c1"># Unwind the shortcomings array</span>
    <span class="p">{</span><span class="s2">&quot;$unwind&quot;</span><span class="p">:</span> <span class="s2">&quot;$vehicle.roadworthiness.shortcomings&quot;</span><span class="p">},</span>
    
    <span class="c1"># Group by shortcomings and vehicle make-model to count occurrences</span>
    <span class="p">{</span>
        <span class="s2">&quot;$group&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;shortcoming&quot;</span><span class="p">:</span> <span class="s2">&quot;$vehicle.roadworthiness.shortcomings&quot;</span><span class="p">,</span>
                <span class="s2">&quot;make&quot;</span><span class="p">:</span> <span class="s2">&quot;$vehicle.make&quot;</span><span class="p">,</span>
                <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="s2">&quot;$vehicle.model&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$sum&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    
    <span class="c1"># Sort by shortcoming and descending count</span>
    <span class="p">{</span>
        <span class="s2">&quot;$sort&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;_id.shortcoming&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span>
        <span class="p">}</span>
    <span class="p">},</span>
    
    <span class="c1"># Group by shortcoming to get the most frequent make and model</span>
    <span class="p">{</span>
        <span class="s2">&quot;$group&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="s2">&quot;$_id.shortcoming&quot;</span><span class="p">,</span>
            <span class="s2">&quot;most_frequent_make&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$first&quot;</span><span class="p">:</span> <span class="s2">&quot;$_id.make&quot;</span><span class="p">},</span>
            <span class="s2">&quot;most_frequent_model&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$first&quot;</span><span class="p">:</span> <span class="s2">&quot;$_id.model&quot;</span><span class="p">},</span>
            <span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$first&quot;</span><span class="p">:</span> <span class="s2">&quot;$count&quot;</span><span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    
    <span class="c1"># Optionally, sort by the shortcoming for better readability</span>
    <span class="p">{</span>
        <span class="s2">&quot;$sort&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
    <span class="p">}</span>
<span class="p">]</span>

<span class="n">results_query</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">radar_tickets_collection</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">pipeline</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_query</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;_id&#39;: &#39;accessories not allowed&#39;,
  &#39;most_frequent_make&#39;: &#39;Bemev&#39;,
  &#39;most_frequent_model&#39;: &#39;Berlin&#39;,
  &#39;count&#39;: 805},
 {&#39;_id&#39;: &#39;broken hand brake&#39;,
  &#39;most_frequent_make&#39;: &#39;Rinaul&#39;,
  &#39;most_frequent_model&#39;: &#39;Charco&#39;,
  &#39;count&#39;: 779},
 {&#39;_id&#39;: &#39;broken headlight&#39;,
  &#39;most_frequent_make&#39;: &#39;Bemev&#39;,
  &#39;most_frequent_model&#39;: &#39;Berlin&#39;,
  &#39;count&#39;: 785},
 {&#39;_id&#39;: &#39;cirulillo  of distribuitor failure&#39;,
  &#39;most_frequent_make&#39;: &#39;Bemev&#39;,
  &#39;most_frequent_model&#39;: &#39;Berlin&#39;,
  &#39;count&#39;: 792},
 {&#39;_id&#39;: &#39;damaged chassis&#39;,
  &#39;most_frequent_make&#39;: &#39;Bemev&#39;,
  &#39;most_frequent_model&#39;: &#39;Berlin&#39;,
  &#39;count&#39;: 785},
 {&#39;_id&#39;: &#39;damaged license plate&#39;,
  &#39;most_frequent_make&#39;: &#39;Rinaul&#39;,
  &#39;most_frequent_model&#39;: &#39;Charco&#39;,
  &#39;count&#39;: 783},
 {&#39;_id&#39;: &#39;defective bulb&#39;,
  &#39;most_frequent_make&#39;: &#39;Bemev&#39;,
  &#39;most_frequent_model&#39;: &#39;Berlin&#39;,
  &#39;count&#39;: 800},
 {&#39;_id&#39;: &#39;excess smoke&#39;,
  &#39;most_frequent_make&#39;: &#39;Bemev&#39;,
  &#39;most_frequent_model&#39;: &#39;Berlin&#39;,
  &#39;count&#39;: 777},
 {&#39;_id&#39;: &#39;exhaust pipe&#39;,
  &#39;most_frequent_make&#39;: &#39;Bemev&#39;,
  &#39;most_frequent_model&#39;: &#39;Berlin&#39;,
  &#39;count&#39;: 775},
 {&#39;_id&#39;: &#39;improperly regulated lights&#39;,
  &#39;most_frequent_make&#39;: &#39;Bemev&#39;,
  &#39;most_frequent_model&#39;: &#39;Berlin&#39;,
  &#39;count&#39;: 784},
 {&#39;_id&#39;: &#39;insufficient braking&#39;,
  &#39;most_frequent_make&#39;: &#39;Bemev&#39;,
  &#39;most_frequent_model&#39;: &#39;Berlin&#39;,
  &#39;count&#39;: 814},
 {&#39;_id&#39;: &#39;minor faults&#39;,
  &#39;most_frequent_make&#39;: &#39;Bemev&#39;,
  &#39;most_frequent_model&#39;: &#39;Berlin&#39;,
  &#39;count&#39;: 788},
 {&#39;_id&#39;: &#39;spoiled engine&#39;,
  &#39;most_frequent_make&#39;: &#39;Rinaul&#39;,
  &#39;most_frequent_model&#39;: &#39;Charco&#39;,
  &#39;count&#39;: 795},
 {&#39;_id&#39;: &#39;windshield in poor condition&#39;,
  &#39;most_frequent_make&#39;: &#39;Bemev&#39;,
  &#39;most_frequent_model&#39;: &#39;Berlin&#39;,
  &#39;count&#39;: 781},
 {&#39;_id&#39;: &#39;worn tires&#39;,
  &#39;most_frequent_make&#39;: &#39;Bemev&#39;,
  &#39;most_frequent_model&#39;: &#39;Berlin&#39;,
  &#39;count&#39;: 781}]
</pre></div>
</div>
</div>
</div>
</section>
<section id="query-6">
<h3>Query 6<a class="headerlink" href="#query-6" title="Link to this heading">#</a></h3>
<p><strong>Build two lists (in the same query): the “Fast” drivers (those
in the top quartile of average speed, while in the bottom quartile of summation of tickets’
amount); and the “Furious” (just the opposite, top ticketing and bottom racing).</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Step 1: Calculate top quartile of average speed</span>

<span class="n">pipeline_speed</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;$group&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="s2">&quot;$vehicle.Driver.DNI&quot;</span><span class="p">,</span>
            <span class="s2">&quot;avg_speed&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$avg&quot;</span><span class="p">:</span> <span class="s2">&quot;$Record.speed&quot;</span><span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;$project&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;avg_speed&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$round&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;$avg_speed&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">]}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">]</span>

<span class="n">results_speed</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">radar_tickets_collection</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">pipeline_speed</span><span class="p">))</span>
<span class="n">avg_speed_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;avg_speed&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">results_speed</span><span class="p">]</span>
<span class="n">avg_speed_quantile_75</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">avg_speed_values</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span>
<span class="n">avg_speed_quantile_25</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">avg_speed_values</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>


<span class="c1"># Step 2: Calculate bottom quartile of summation of tickets</span>

<span class="n">pipeline_tickets</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;$group&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="s2">&quot;$vehicle.Driver.DNI&quot;</span><span class="p">,</span>
            <span class="s2">&quot;avg_ticket_amount&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$avg&quot;</span><span class="p">:</span> <span class="s2">&quot;$Speed ticket.amount&quot;</span><span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;$project&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;avg_ticket_amount&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$round&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;$avg_ticket_amount&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">]}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">]</span>

<span class="n">results_ticket_amount</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">radar_tickets_collection</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">pipeline_tickets</span><span class="p">))</span>
<span class="n">avg_ticket_amount_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;avg_speed&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">results_speed</span><span class="p">]</span>
<span class="n">avg_ticket_amount_quantile_75</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">avg_ticket_amount_values</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span>
<span class="n">avg_ticket_amount_quantile_25</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">avg_ticket_amount_values</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>


<span class="c1"># Step 3: Computing the fast drivers</span>

<span class="n">fast_drivers_query</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;$and&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;Record.speed&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$gte&quot;</span><span class="p">:</span> <span class="n">avg_speed_quantile_75</span><span class="p">}},</span>
                               <span class="p">{</span><span class="s2">&quot;Speed ticket.Amount&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$lte&quot;</span><span class="p">:</span> <span class="n">avg_ticket_amount_quantile_25</span><span class="p">}}]}</span>

<span class="n">fast_drivers_projection</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;vehicle.Driver.DNI&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Record.speed&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Speed ticket.Amount&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>   

<span class="n">fast_drivers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">radar_tickets_collection</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">fast_drivers_query</span><span class="p">,</span> <span class="n">fast_drivers_projection</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;Record.speed&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>


<span class="c1"># Step 4: Computing the furious drivers</span>

<span class="n">furious_drivers_query</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;$and&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;Record.speed&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$lte&quot;</span><span class="p">:</span> <span class="n">avg_speed_quantile_25</span><span class="p">}},</span>
                               <span class="p">{</span><span class="s2">&quot;Speed ticket.Amount&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$gte&quot;</span><span class="p">:</span> <span class="n">avg_ticket_amount_quantile_75</span><span class="p">}}]}</span>

<span class="n">furious_drivers_projection</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;vehicle.Driver.DNI&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Record.speed&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Speed ticket.Amount&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>   

<span class="n">furious_drivers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">radar_tickets_collection</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">furious_drivers_query</span><span class="p">,</span> <span class="n">furious_drivers_projection</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;Speed ticket.Amount&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fast_drivers</span>
</pre></div>
</div>
</div>
</div>
<p>A sample of the query results provided running the previous cell.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">...</span><span class="p">,</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Driver&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;76150280V&#39;</span><span class="p">}},</span>
  <span class="s1">&#39;Record&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;speed&#39;</span><span class="p">:</span> <span class="mi">110</span><span class="p">},</span>
  <span class="s1">&#39;Speed ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Amount&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Driver&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;80498155H&#39;</span><span class="p">}},</span>
  <span class="s1">&#39;Record&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;speed&#39;</span><span class="p">:</span> <span class="mi">110</span><span class="p">},</span>
  <span class="s1">&#39;Speed ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Amount&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Driver&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;88900195C&#39;</span><span class="p">}},</span>
  <span class="s1">&#39;Record&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;speed&#39;</span><span class="p">:</span> <span class="mi">110</span><span class="p">},</span>
  <span class="s1">&#39;Speed ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Amount&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Driver&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;58444159D&#39;</span><span class="p">}},</span>
  <span class="s1">&#39;Record&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;speed&#39;</span><span class="p">:</span> <span class="mi">110</span><span class="p">},</span>
  <span class="s1">&#39;Speed ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Amount&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Driver&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;55533072D&#39;</span><span class="p">}},</span>
  <span class="s1">&#39;Record&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;speed&#39;</span><span class="p">:</span> <span class="mi">110</span><span class="p">},</span>
  <span class="s1">&#39;Speed ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Amount&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">}},</span>
 <span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fast_drivers</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;vehicle&#39;: {&#39;Driver&#39;: {&#39;DNI&#39;: &#39;31414734T&#39;}},
  &#39;Record&#39;: {&#39;speed&#39;: 107},
  &#39;Speed ticket&#39;: {&#39;Amount&#39;: 70}},
 {&#39;vehicle&#39;: {&#39;Driver&#39;: {&#39;DNI&#39;: &#39;23939454L&#39;}},
  &#39;Record&#39;: {&#39;speed&#39;: 107},
  &#39;Speed ticket&#39;: {&#39;Amount&#39;: 70}},
 {&#39;vehicle&#39;: {&#39;Driver&#39;: {&#39;DNI&#39;: &#39;65871451A&#39;}},
  &#39;Record&#39;: {&#39;speed&#39;: 107},
  &#39;Speed ticket&#39;: {&#39;Amount&#39;: 70}},
 {&#39;vehicle&#39;: {&#39;Driver&#39;: {&#39;DNI&#39;: &#39;74026572Z&#39;}},
  &#39;Record&#39;: {&#39;speed&#39;: 107},
  &#39;Speed ticket&#39;: {&#39;Amount&#39;: 70}}]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">fast_drivers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3301
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">furious_drivers</span>
</pre></div>
</div>
</div>
</div>
<p>A sample of the query results provided running the previous cell.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">...</span><span class="p">,</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Driver&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;78455829T&#39;</span><span class="p">}},</span>
  <span class="s1">&#39;Record&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;speed&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">},</span>
  <span class="s1">&#39;Speed ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Amount&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Driver&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;42038947F&#39;</span><span class="p">}},</span>
  <span class="s1">&#39;Record&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;speed&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">},</span>
  <span class="s1">&#39;Speed ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Amount&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Driver&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;25877835Y&#39;</span><span class="p">}},</span>
  <span class="s1">&#39;Record&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;speed&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">},</span>
  <span class="s1">&#39;Speed ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Amount&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Driver&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;45191051F&#39;</span><span class="p">}},</span>
  <span class="s1">&#39;Record&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;speed&#39;</span><span class="p">:</span> <span class="mi">70</span><span class="p">},</span>
  <span class="s1">&#39;Speed ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Amount&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;vehicle&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Driver&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;DNI&#39;</span><span class="p">:</span> <span class="s1">&#39;58793740J&#39;</span><span class="p">}},</span>
  <span class="s1">&#39;Record&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;speed&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">},</span>
  <span class="s1">&#39;Speed ticket&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Amount&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">}},</span>
 <span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">furious_drivers</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;vehicle&#39;: {&#39;Driver&#39;: {&#39;DNI&#39;: &#39;19502956Z&#39;}},
  &#39;Record&#39;: {&#39;speed&#39;: 61},
  &#39;Speed ticket&#39;: {&#39;Amount&#39;: 110}},
 {&#39;vehicle&#39;: {&#39;Driver&#39;: {&#39;DNI&#39;: &#39;20304333W&#39;}},
  &#39;Record&#39;: {&#39;speed&#39;: 91},
  &#39;Speed ticket&#39;: {&#39;Amount&#39;: 110}},
 {&#39;vehicle&#39;: {&#39;Driver&#39;: {&#39;DNI&#39;: &#39;47591599E&#39;}},
  &#39;Record&#39;: {&#39;speed&#39;: 91},
  &#39;Speed ticket&#39;: {&#39;Amount&#39;: 110}},
 {&#39;vehicle&#39;: {&#39;Driver&#39;: {&#39;DNI&#39;: &#39;17817924P&#39;}},
  &#39;Record&#39;: {&#39;speed&#39;: 61},
  &#39;Speed ticket&#39;: {&#39;Amount&#39;: 110}}]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">furious_drivers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10047
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Introduction to MongoDB through <code class="docutils literal notranslate"><span class="pre">PyMongo</span></code></p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#requirements">Requirements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#see-your-data-bases">See your data bases</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#remove-a-data-base">Remove a data base</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-new-data-base">Create a new data base</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-new-collection-in-the-data-base">Create a new collection in the data base</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregate-a-new-document-into-a-collection-from-a-data-base">Aggregate a new document into a collection from a data base</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregate-several-new-documents-into-a-collection-from-a-data-base">Aggregate several new documents into a collection from a data base</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#number-of-documents-in-a-collection">Number of documents in a collection</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#remove-a-collection">Remove a collection</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering-documents-in-a-collection">Filtering documents in a collection</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting">Sorting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#remove-documents-from-a-collection">Remove documents from a collection</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#update-a-document">Update a document</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quering-radar-tickets-db">Quering Radar Tickets DB</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query-1"><strong>Query 1</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query-2">Query 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query-3">Query 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query-4">Query 4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query-5">Query 5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query-6">Query 6</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Fabio Scielzo Ortiz
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>